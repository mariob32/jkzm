<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Jazdeck√Ω klub Zelen√° m√≠ƒæa</title>
    <meta name="description" id="metaDescription" content="Profesion√°lny jazdeck√Ω klub - tr√©ningy, ustajnenie, s√∫≈•a≈æe. Kvalitn√© slu≈æby pre v≈°etk√Ωch milovn√≠kov kon√≠.">
    <meta name="keywords" content="jazdeck√Ω klub, kone, jazdectvo, tr√©ningy, ustajnenie, s√∫≈•a≈æe, jazdeck√° ≈°kola">
    <meta name="author" content="Jazdeck√Ω klub Zelen√° m√≠ƒæa">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" id="ogTitle" content="Jazdeck√Ω klub Zelen√° m√≠ƒæa">
    <meta property="og:description" id="ogDescription" content="Profesion√°lny jazdeck√Ω klub - tr√©ningy, ustajnenie, s√∫≈•a≈æe">
    <meta property="og:image" content="/assets/logo.png">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2d5a27">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2d5a27;
            --primary-light: #4a8c3f;
            --secondary: #8b4513;
            --accent: #d4a574;
            --dark: #1a1a1a;
            --light: #f8f9fa;
            --gray: #6c757d;
            --white: #ffffff;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; color: var(--dark); line-height: 1.6; }
        a { color: var(--primary); text-decoration: none; }
        a:hover { text-decoration: underline; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
        
        header { background: var(--white); box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        .header-inner { display: flex; align-items: center; justify-content: space-between; padding: 1rem 0; }
        .logo { display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .logo img { height: 65px; }
        nav { display: flex; gap: 2rem; }
        nav a { color: var(--dark); font-weight: 500; padding: 0.5rem 0; border-bottom: 2px solid transparent; transition: all 0.3s; }
        nav a:hover, nav a.active { color: var(--primary); border-bottom-color: var(--primary); text-decoration: none; }
        .mobile-menu { display: none; cursor: pointer; font-size: 1.5rem; }
        
        .hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: var(--white); padding: 5rem 0; text-align: center; }
        .hero h1 { font-size: 3rem; margin-bottom: 1rem; }
        .hero p { font-size: 1.25rem; opacity: 0.9; max-width: 600px; margin: 0 auto 2rem; }
        
        .btn { display: inline-block; padding: 0.875rem 2rem; border-radius: 8px; font-weight: 600; transition: all 0.3s; border: none; cursor: pointer; }
        .btn-primary { background: var(--white); color: var(--primary); }
        .btn-primary:hover { background: var(--accent); color: var(--white); text-decoration: none; }
        .btn-secondary { background: transparent; color: var(--white); border: 2px solid var(--white); margin-left: 1rem; }
        .btn-secondary:hover { background: var(--white); color: var(--primary); text-decoration: none; }
        
        /* 2% CTA Banner */
        .cta-2percent {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            padding: 1.25rem 0;
        }
        .cta-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
            flex-wrap: wrap;
        }
        .cta-text { color: white; }
        .cta-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .cta-text h3 { font-size: 1.25rem; margin-bottom: 0.25rem; }
        .cta-text p { font-size: 0.95rem; opacity: 0.95; margin: 0; }
        .cta-text strong { font-weight: 700; }
        .btn-cta {
            display: inline-block;
            background: white;
            color: #f57c00;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            white-space: nowrap;
            transition: all 0.3s;
        }
        .btn-cta:hover { background: #fff3e0; text-decoration: none; transform: translateY(-2px); }
        
        @media (max-width: 600px) {
            .cta-content { justify-content: center; text-align: center; }
            .cta-text h3 { font-size: 1.1rem; }
            .cta-text p { font-size: 0.85rem; }
        }
        
        section { padding: 4rem 0; }
        .section-title { text-align: center; margin-bottom: 3rem; }
        .section-title h2 { font-size: 2.25rem; color: var(--dark); margin-bottom: 0.5rem; }
        .section-title p { color: var(--gray); font-size: 1.1rem; }
        
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .service-card { background: var(--white); border-radius: 12px; padding: 2rem; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.08); transition: transform 0.3s; }
        .service-card:hover { transform: translateY(-5px); }
        .service-icon { font-size: 3rem; margin-bottom: 1rem; }
        .service-card h3 { color: var(--primary); margin-bottom: 0.75rem; }
        .service-badge { display: inline-block; margin-top: 1rem; padding: 0.35rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-full { background: #fee2e2; color: #dc2626; }
        .badge-soon { background: #fef3c7; color: #d97706; }
        .badge-new { background: #d1fae5; color: #059669; }
        .badge-sale { background: #dbeafe; color: #2563eb; }
        
        .news-section { background: var(--light); }
        .news-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2rem; }
        .news-card { background: var(--white); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.08); cursor: pointer; transition: transform 0.3s; }
        .news-card:hover { transform: translateY(-5px); }
        .news-card img { width: 100%; height: 200px; object-fit: cover; }
        .news-card-body { padding: 1.5rem; }
        .news-category { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; color: var(--white); margin-bottom: 0.75rem; }
        .news-card h3 { margin-bottom: 0.5rem; font-size: 1.25rem; color: var(--dark); }
        .news-excerpt { color: var(--gray); font-size: 0.9rem; margin: 0.5rem 0; }
        .news-date { color: var(--gray); font-size: 0.85rem; }
        
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
        .gallery-item { position: relative; border-radius: 12px; overflow: hidden; aspect-ratio: 4/3; cursor: pointer; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .gallery-item:hover img { transform: scale(1.05); }
        .gallery-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 1rem; background: linear-gradient(transparent, rgba(0,0,0,0.7)); color: var(--white); }
        .gallery-overlay h4 { font-size: 1rem; margin-bottom: 0.25rem; }
        .gallery-overlay span { font-size: 0.85rem; opacity: 0.8; }
        
        .partners-section { background: var(--light); }
        .partners-container { text-align: center; }
        .partners-group { margin-bottom: 2.5rem; }
        .partners-group:last-child { margin-bottom: 0; }
        .partners-group-title { font-size: 0.85rem; color: var(--gray); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1.5rem; font-weight: 600; }
        .partners-grid { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 2rem; }
        .partner-item { display: block; margin: 1rem; text-align: center; }
        .partner-item a { text-decoration: none; display: inline-block; }
        .partner-logo { max-height: 70px; max-width: 160px; transition: all 0.3s; display: inline-block !important; }
        .partner-logo:hover { transform: scale(1.05); }
        .partner-name { font-size: 0.9rem; color: var(--dark); font-weight: 500; }
        .main-sponsor .partner-logo { max-height: 100px; max-width: 220px; }
        
        .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; }
        .contact-info h3 { color: var(--primary); margin-bottom: 1.5rem; }
        .contact-item { display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1.5rem; }
        .contact-icon { font-size: 1.5rem; color: var(--primary); }
        .contact-item.address-box { background: #f8f9fa; padding: 1rem; border-radius: 10px; border-left: 4px solid var(--primary); }
        .contact-item.address-box.prev√°dzka { border-left-color: var(--secondary); }
        .contact-map { border-radius: 12px; overflow: hidden; height: 100%; min-height: 300px; }
        .contact-map iframe { width: 100%; height: 100%; border: none; }
        
        footer { background: var(--dark); color: var(--white); padding: 3rem 0 1.5rem; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .footer-col h4 { color: var(--accent); margin-bottom: 1rem; }
        .footer-col a { display: block; color: rgba(255,255,255,0.7); padding: 0.25rem 0; }
        .footer-col a:hover { color: var(--white); }
        .social-links { display: flex; gap: 1rem; margin-top: 1rem; }
        .social-links a { display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: rgba(255,255,255,0.1); border-radius: 50%; font-size: 1.25rem; transition: background 0.3s; }
        .social-links a:hover { background: var(--primary); }
        .footer-bottom { text-align: center; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.5); font-size: 0.9rem; }
        
        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; overflow-y: auto; padding: 2rem 1rem; }
        .modal.active { display: flex; justify-content: center; align-items: flex-start; }
        .modal-content { background: var(--white); border-radius: 16px; max-width: 800px; width: 100%; max-height: none; position: relative; margin: auto; }
        .modal-close { position: absolute; top: 1rem; right: 1rem; background: var(--white); border: none; font-size: 1.5rem; cursor: pointer; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 10; }
        .modal-close:hover { background: var(--light); }
        .article-modal-cover { width: 100%; height: 300px; object-fit: cover; border-radius: 16px 16px 0 0; }
        .article-modal-body { padding: 2rem; }
        .article-modal-body h1 { font-size: 2rem; margin-bottom: 1rem; line-height: 1.3; }
        .article-modal-meta { display: flex; gap: 1.5rem; color: var(--gray); font-size: 0.9rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .article-modal-content { line-height: 1.8; }
        .article-modal-content p { margin-bottom: 1rem; }
        
        @media (max-width: 768px) {
            .mobile-menu { display: block; }
            nav { display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--white); flex-direction: column; padding: 1rem; gap: 0; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
            nav.active { display: flex; }
            nav a { padding: 1rem; border-bottom: 1px solid var(--light); }
            .hero h1 { font-size: 2rem; }
            .btn-secondary { margin: 1rem 0 0; display: block; }
            .contact-grid { grid-template-columns: 1fr; }
            .news-grid { grid-template-columns: 1fr; }
            .article-modal-cover { height: 200px; }
            .article-modal-body h1 { font-size: 1.5rem; }
        }
        
        .loading { text-align: center; padding: 3rem; color: var(--gray); }
        .placeholder-img { background: linear-gradient(135deg, var(--primary-light), var(--accent)); display: flex; align-items: center; justify-content: center; font-size: 3rem; color: var(--white); }
    </style>
</head>
<body>
    <header>
        <div class="container header-inner">
            <a href="/" class="logo">
                <img src="/assets/logo.png" alt="Logo" onerror="this.style.display='none'">
                <span id="siteName">Jazdeck√Ω klub</span>
            </a>
            <div class="mobile-menu" onclick="toggleMenu()">‚ò∞</div>
            <nav id="mainNav">
                <a href="/" class="active">Domov</a>
                <a href="#news">Novinky</a>
                <a href="#gallery">Gal√©ria</a>
                <a href="#services">Slu≈æby</a>
                <a href="/o-klube.html">O klube</a>
                <a href="#contact">Kontakt</a>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h1 id="heroTitle">Vitajte v jazdeckom klube</h1>
            <p id="heroDesc">Profesion√°lne tr√©ningy, kvalitn√© ustajnenie a priateƒæsk√° atmosf√©ra pre v≈°etk√Ωch milovn√≠kov kon√≠</p>
            <a href="#contact" class="btn btn-primary">Kontaktujte n√°s</a>
            <a href="#services" class="btn btn-secondary">Na≈°e slu≈æby</a>
        </div>
    </section>

    <!-- 2% DANE BANNER -->
    <section class="cta-2percent">
        <div class="container">
            <div class="cta-content">
                <div class="cta-text">
                    <span class="cta-badge">üíù 2% z dane</span>
                    <h3>Podporte n√°≈° klub - darujte n√°m 2% z dane!</h3>
                    <p>IƒåO: <strong>53536002</strong> ‚Ä¢ Jazdeck√Ω klub Zelen√° m√≠ƒæa Jaslovsk√© Bohunice</p>
                </div>
                <a href="/o-klube.html#2percenta" class="btn-cta">Ako na to? ‚Üí</a>
            </div>
        </div>
    </section>

    <section id="services">
        <div class="container">
            <div class="section-title"><h2>Na≈°e slu≈æby</h2><p>Komplexn√° starostlivos≈• pre v√°s a va≈°e kone</p></div>
            <div class="services-grid" id="servicesGrid">
                <div class="loading">Naƒç√≠tavam slu≈æby...</div>
            </div>
        </div>
    </section>

    <section id="news" class="news-section">
        <div class="container">
            <div class="section-title"><h2>Novinky</h2><p>ƒåo je nov√© v na≈°om klube</p></div>
            <div class="news-grid" id="newsGrid"><div class="loading">Naƒç√≠tavam ƒçl√°nky...</div></div>
        </div>
    </section>

    <section id="gallery">
        <div class="container">
            <div class="section-title"><h2>Gal√©ria</h2><p>Pozrite si na≈°e priestory a akcie</p></div>
            <div class="gallery-grid" id="galleryGrid"><div class="loading">Naƒç√≠tavam gal√©riu...</div></div>
        </div>
    </section>

    <section class="partners-section">
        <div class="container">
            <div class="section-title"><h2>Partneri a sponzori</h2><p>ƒéakujeme za podporu</p></div>
            <div class="partners-container" id="partnersContainer"><div class="loading">Naƒç√≠tavam partnerov...</div></div>
        </div>
    </section>

    <section id="contact">
        <div class="container">
            <div class="section-title"><h2>Kontakt</h2><p>Radi v√°s priv√≠tame</p></div>
            <div class="contact-grid">
                <div class="contact-info">
                    <h3>Kontaktn√© √∫daje</h3>
                    <div class="contact-item address-box"><span class="contact-icon">üè†</span><div><strong>S√≠dlo (kore≈°pondenƒçn√° adresa)</strong><br>Nov√° ulica 297/41, 919 30 Jaslovsk√© Bohunice</div></div>
                    <div class="contact-item address-box prev√°dzka"><span class="contact-icon">üê¥</span><div><strong>Prev√°dzka (are√°l)</strong><br>Are√°l PD, Hlavn√° Jaslovce 124/127, 919 30 Jaslovsk√© Bohunice</div></div>
                    <div class="contact-item"><span class="contact-icon">üìû</span><div><strong>Telef√≥n</strong><br><span id="contactPhone">-</span></div></div>
                    <div class="contact-item"><span class="contact-icon">‚úâÔ∏è</span><div><strong>Email</strong><br><span id="contactEmail">-</span></div></div>
                    <div class="social-links" id="socialLinks"></div>
                </div>
                <div class="contact-map" id="mapContainer"><iframe src="https://maps.google.com/maps?q=Jazdeck√Ω+klub+Zelen√°+m√≠ƒæa+Jaslovsk√©+Bohunice&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe></div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col"><h4 id="footerName">Jazdeck√Ω klub</h4><p style="color:rgba(255,255,255,0.7)" id="footerDesc">Profesion√°lny jazdeck√Ω klub.</p></div>
                <div class="footer-col"><h4>R√Ωchle odkazy</h4><a href="#services">Slu≈æby</a><a href="#news">Novinky</a><a href="#gallery">Gal√©ria</a><a href="/o-klube.html">O klube / 2%</a><a href="#contact">Kontakt</a></div>
                <div class="footer-col"><h4>Kontakt</h4><p style="color:rgba(255,255,255,0.7)"><span id="footerPhone"></span><br><span id="footerEmail"></span></p></div>
            </div>
            <div class="footer-bottom">¬© 2025 <span id="copyrightName">Jazdeck√Ω klub</span>. V≈°etky pr√°va vyhraden√©. | <a href="#" onclick="showGdpr();return false;" style="color:rgba(255,255,255,0.5)">GDPR</a> | <a href="/admin" style="color:rgba(255,255,255,0.5)">Admin</a></div>
        </div>
    </footer>

    <!-- ARTICLE MODAL -->
    <div class="modal" id="articleModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeArticleModal()">√ó</button>
            <div id="articleModalContent"></div>
        </div>
    </div>

    <script>
        function toggleMenu() { document.getElementById('mainNav').classList.toggle('active'); }
        
        // Close modal on background click
        document.getElementById('articleModal').addEventListener('click', function(e) {
            if (e.target === this) closeArticleModal();
        });
        
        // Close modal on ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeArticleModal();
        });
        
        function closeArticleModal() {
            document.getElementById('articleModal').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        async function openArticle(id) {
            try {
                const res = await fetch('/api/articles/' + id);
                if (!res.ok) throw new Error('ƒål√°nok nen√°jden√Ω');
                const article = await res.json();
                
                const cat = article.article_categories;
                const catHtml = cat ? '<span class="news-category" style="background:'+cat.color+'">'+cat.name+'</span>' : '';
                const date = article.published_at ? new Date(article.published_at).toLocaleDateString('sk', {day:'numeric',month:'long',year:'numeric'}) : '';
                const coverHtml = article.cover_image ? '<img src="'+article.cover_image+'" class="article-modal-cover" alt="'+article.title+'">' : '';
                
                // Simple content formatting
                let content = article.content || '';
                content = content.replace(/\n\n/g, '</p><p>').replace(/\n/g, '<br>');
                if (content && !content.startsWith('<p>')) content = '<p>' + content + '</p>';
                
                const html = `
                    ${coverHtml}
                    <div class="article-modal-body">
                        ${catHtml}
                        <h1>${article.title}</h1>
                        <div class="article-modal-meta">
                            ${date ? '<span>üìÖ '+date+'</span>' : ''}
                            ${article.author ? '<span>‚úçÔ∏è '+article.author+'</span>' : ''}
                        </div>
                        <div class="article-modal-content">${content}</div>
                    </div>
                `;
                
                document.getElementById('articleModalContent').innerHTML = html;
                document.getElementById('articleModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            } catch(e) {
                alert('Chyba pri naƒç√≠tan√≠ ƒçl√°nku: ' + e.message);
            }
        }
        
        async function loadSettings() {
            try {
                const res = await fetch('/api/settings');
                const s = await res.json();
                if (s.site_name) {
                    document.getElementById('siteName').textContent = s.site_name;
                    document.getElementById('heroTitle').textContent = 'Vitajte v ' + s.site_name;
                    document.getElementById('footerName').textContent = s.site_name;
                    document.getElementById('copyrightName').textContent = s.site_name;
                    // SEO
                    document.title = s.site_name;
                    document.getElementById('pageTitle')?.setAttribute('content', s.site_name);
                    document.getElementById('ogTitle')?.setAttribute('content', s.site_name);
                }
                if (s.site_description) { 
                    document.getElementById('heroDesc').textContent = s.site_description; 
                    document.getElementById('footerDesc').textContent = s.site_description;
                    // SEO
                    document.getElementById('metaDescription')?.setAttribute('content', s.site_description);
                    document.getElementById('ogDescription')?.setAttribute('content', s.site_description);
                }
                if (s.contact_address) document.getElementById('contactAddress').textContent = s.contact_address;
                if (s.contact_phone) { document.getElementById('contactPhone').innerHTML = '<a href="tel:'+s.contact_phone+'">'+s.contact_phone+'</a>'; document.getElementById('footerPhone').textContent = s.contact_phone; }
                if (s.contact_email) { document.getElementById('contactEmail').innerHTML = '<a href="mailto:'+s.contact_email+'">'+s.contact_email+'</a>'; document.getElementById('footerEmail').textContent = s.contact_email; }
                let social = '';
                if (s.social_facebook) social += '<a href="'+s.social_facebook+'" target="_blank" rel="noopener">üìò</a>';
                if (s.social_instagram) social += '<a href="'+s.social_instagram+'" target="_blank" rel="noopener">üì∑</a>';
                if (s.social_youtube) social += '<a href="'+s.social_youtube+'" target="_blank" rel="noopener">‚ñ∂Ô∏è</a>';
                document.getElementById('socialLinks').innerHTML = social;
                if (s.google_maps_embed) document.getElementById('mapContainer').innerHTML = s.google_maps_embed;
            } catch(e) { /* silent */ }
        }
        
        async function loadServices() {
            try {
                const res = await fetch('/api/services?active_only=true');
                const services = await res.json();
                const grid = document.getElementById('servicesGrid');
                
                if (!Array.isArray(services) || !services.length) { 
                    grid.innerHTML = '<p style="text-align:center;color:var(--gray);grid-column:1/-1">Zatiaƒæ ≈æiadne slu≈æby</p>'; 
                    return; 
                }
                
                const badgeClasses = {
                    'full': 'badge-full',
                    'soon': 'badge-soon',
                    'new': 'badge-new',
                    'sale': 'badge-sale'
                };
                
                grid.innerHTML = services.map(s => {
                    let badgeHtml = '';
                    if (s.badge_text && s.badge_type) {
                        const badgeClass = badgeClasses[s.badge_type] || '';
                        badgeHtml = '<span class="service-badge ' + badgeClass + '">' + s.badge_text + '</span>';
                    }
                    
                    return '<div class="service-card"><div class="service-icon">' + (s.icon || 'üèá') + '</div><h3>' + s.title + '</h3><p>' + (s.description || '') + '</p>' + badgeHtml + '</div>';
                }).join('');
            } catch(e) { 
                document.getElementById('servicesGrid').innerHTML = '<p style="color:var(--gray)">Chyba pri naƒç√≠tan√≠ slu≈æieb</p>'; 
            }
        }
        
        async function loadArticles() {
            try {
                const res = await fetch('/api/articles?status=published&limit=6');
                const articles = await res.json();
                const grid = document.getElementById('newsGrid');
                if (!Array.isArray(articles) || !articles.length) { grid.innerHTML = '<p style="text-align:center;color:var(--gray);grid-column:1/-1">Zatiaƒæ ≈æiadne novinky</p>'; return; }
                grid.innerHTML = articles.map(a => {
                    const date = a.published_at ? new Date(a.published_at).toLocaleDateString('sk') : '';
                    const cat = a.article_categories;
                    const catHtml = cat ? '<span class="news-category" style="background:'+cat.color+'">'+cat.name+'</span>' : '';
                    const img = a.cover_image ? '<img src="'+a.cover_image+'" alt="'+a.title+'">' : '<div class="placeholder-img" style="height:200px">üì∞</div>';
                    return '<article class="news-card" onclick="openArticle(\''+a.id+'\')">'+img+'<div class="news-card-body">'+catHtml+'<h3>'+a.title+'</h3><p class="news-excerpt">'+(a.excerpt||'')+'</p><span class="news-date">'+date+'</span></div></article>';
                }).join('');
            } catch(e) { document.getElementById('newsGrid').innerHTML = '<p style="color:var(--gray)">Chyba pri naƒç√≠tan√≠</p>'; }
        }
        
        async function loadGallery() {
            try {
                const res = await fetch('/api/albums?public_only=true');
                const albums = await res.json();
                const grid = document.getElementById('galleryGrid');
                if (!Array.isArray(albums) || !albums.length) { 
                    grid.innerHTML = '<p style="text-align:center;color:var(--gray);grid-column:1/-1">Zatiaƒæ ≈æiadne albumy</p>'; 
                    return; 
                }
                grid.innerHTML = albums.slice(0,6).map(a => {
                    // photos m√¥≈æe by≈• array alebo objekt s count
                    let count = 0;
                    if (Array.isArray(a.photos)) count = a.photos.length;
                    else if (a.photos && a.photos[0] && a.photos[0].count !== undefined) count = a.photos[0].count;
                    
                    const img = a.cover_image 
                        ? '<img src="'+a.cover_image+'" alt="Album">' 
                        : '<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:3rem;background:linear-gradient(135deg,var(--primary),var(--secondary))">üñºÔ∏è</div>';
                    
                    // Escape pre HTML atrib√∫ty
                    const safeId = a.id;
                    const safeTitle = (a.title || '').replace(/"/g, '&quot;');
                    
                    return '<div class="gallery-item" data-album-id="'+safeId+'" data-album-title="'+safeTitle+'">'+img+'<div class="gallery-overlay"><h4>'+(a.title || 'Album')+'</h4><span>'+count+' fotiek</span></div></div>';
                }).join('');
                
                // Prida≈• event listenery
                grid.querySelectorAll('.gallery-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const albumId = this.dataset.albumId;
                        const albumTitle = this.dataset.albumTitle;
                        if (albumId) openAlbum(albumId, albumTitle);
                    });
                });
            } catch(e) { 
                console.error('Gallery error:', e);
                document.getElementById('galleryGrid').innerHTML = '<p style="color:var(--gray)">Chyba pri naƒç√≠tan√≠ gal√©rie</p>'; 
            }
        }
        
        // Lightbox pre gal√©riu
        let currentPhotos = [];
        let currentPhotoIndex = 0;
        
        async function openAlbum(albumId, albumTitle) {
            try {
                console.log('Opening album:', albumId, albumTitle);
                const res = await fetch('/api/photos?album_id=' + albumId);
                
                if (!res.ok) {
                    throw new Error('API error: ' + res.status);
                }
                
                const photos = await res.json();
                console.log('Photos loaded:', photos);
                
                if (!photos || !Array.isArray(photos) || photos.length === 0) {
                    alert('Album je pr√°zdny - najprv nahrajte fotky v admin paneli');
                    return;
                }
                
                currentPhotos = photos;
                currentPhotoIndex = 0;
                
                document.getElementById('lightboxTitle').textContent = albumTitle || 'Album';
                showPhoto(0);
                document.getElementById('lightbox').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            } catch(e) {
                console.error('Error loading album:', e);
                alert('Chyba pri naƒç√≠tan√≠ albumu: ' + e.message);
            }
        }
        
        function showPhoto(index) {
            if (index < 0) index = currentPhotos.length - 1;
            if (index >= currentPhotos.length) index = 0;
            currentPhotoIndex = index;
            
            const photo = currentPhotos[index];
            const isVideo = photo.url && (photo.url.includes('.mp4') || photo.url.includes('.webm') || photo.url.includes('.mov'));
            
            const mediaContainer = document.getElementById('lightboxMedia');
            if (isVideo) {
                mediaContainer.innerHTML = '<video src="' + photo.url + '" controls autoplay style="max-width:90vw;max-height:80vh"></video>';
            } else {
                mediaContainer.innerHTML = '<img src="' + photo.url + '" alt="' + (photo.title || '') + '" style="max-width:90vw;max-height:80vh;object-fit:contain">';
            }
            
            document.getElementById('lightboxCounter').textContent = (index + 1) + ' / ' + currentPhotos.length;
            document.getElementById('lightboxCaption').textContent = photo.title || '';
            
            // Zobraz/skry ≈°√≠pky
            document.getElementById('lightboxPrev').style.display = currentPhotos.length > 1 ? 'flex' : 'none';
            document.getElementById('lightboxNext').style.display = currentPhotos.length > 1 ? 'flex' : 'none';
        }
        
        function nextPhoto() {
            showPhoto(currentPhotoIndex + 1);
        }
        
        function prevPhoto() {
            showPhoto(currentPhotoIndex - 1);
        }
        
        function closeLightbox() {
            document.getElementById('lightbox').style.display = 'none';
            document.body.style.overflow = '';
            // Zastav video ak hralo
            const video = document.querySelector('#lightboxMedia video');
            if (video) video.pause();
        }
        
        // Kl√°vesov√© skratky pre lightbox
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('lightbox');
            if (lightbox && lightbox.style.display === 'flex') {
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowRight') nextPhoto();
                if (e.key === 'ArrowLeft') prevPhoto();
            }
        });
        
        async function loadPartners() {
            try {
                const res = await fetch('/api/partners');
                const allPartners = await res.json();
                const container = document.getElementById('partnersContainer');
                
                
                
                if (!Array.isArray(allPartners)) {
                    container.innerHTML = '<p style="color:var(--gray)">Chyba pri naƒç√≠tan√≠ partnerov</p>';
                    return;
                }
                
                const partners = allPartners.filter(p => p.is_active === true || p.is_active === null || p.is_active === undefined);
                
                
                
                if (!partners.length) { 
                    container.innerHTML = '<p style="color:var(--gray)">Zatiaƒæ ≈æiadni partneri</p>'; 
                    return; 
                }
                
                const mainSponsors = partners.filter(p => p.partner_type === 'hlavny_sponzor');
                const sponsors = partners.filter(p => p.partner_type === 'sponzor');
                const regularPartners = partners.filter(p => p.partner_type === 'partner' || !p.partner_type);
                const mediaPartners = partners.filter(p => p.partner_type === 'medialny_partner');
                
                
                
                
                let html = '';
                
                if (mainSponsors.length) {
                    html += '<div class="partners-group main-sponsor"><div class="partners-group-title">üèÜ Hlavn√≠ sponzori</div><div class="partners-grid">' + renderPartners(mainSponsors) + '</div></div>';
                }
                if (sponsors.length) {
                    html += '<div class="partners-group"><div class="partners-group-title">‚≠ê Sponzori</div><div class="partners-grid">' + renderPartners(sponsors) + '</div></div>';
                }
                if (regularPartners.length) {
                    html += '<div class="partners-group"><div class="partners-group-title">ü§ù Partneri</div><div class="partners-grid">' + renderPartners(regularPartners) + '</div></div>';
                }
                if (mediaPartners.length) {
                    html += '<div class="partners-group"><div class="partners-group-title">üì∫ Medi√°lni partneri</div><div class="partners-grid">' + renderPartners(mediaPartners) + '</div></div>';
                }
                
                
                container.innerHTML = html || '<p style="color:var(--gray)">Zatiaƒæ ≈æiadni partneri</p>';
            } catch(e) { 
                console.error('Partners error:', e);
                document.getElementById('partnersContainer').innerHTML = '<p style="color:var(--gray)">Chyba pri naƒç√≠tan√≠ partnerov</p>'; 
            }
        }
        
        function renderPartners(partners) {
            let result = '';
            for (let i = 0; i < partners.length; i++) {
                const p = partners[i];
                
                let inner = '';
                if (p.logo_url) {
                    inner = '<img src="' + p.logo_url + '" alt="' + p.name + '" class="partner-logo">';
                } else {
                    inner = '<span class="partner-name">' + p.name + '</span>';
                }
                
                if (p.website) {
                    inner = '<a href="' + p.website + '" target="_blank">' + inner + '</a>';
                }
                
                result += '<div class="partner-item">' + inner + '</div>';
            }
            return result;
        }
        
        document.addEventListener('DOMContentLoaded', () => { 
            loadSettings(); 
            loadServices();
            loadArticles(); 
            loadGallery(); 
            loadPartners(); 
        });
        
        document.querySelectorAll('a[href^="#"]').forEach(a => { 
            a.addEventListener('click', function(e) { 
                e.preventDefault(); 
                const t = document.querySelector(this.getAttribute('href')); 
                if(t) { 
                    t.scrollIntoView({behavior:'smooth'}); 
                    document.getElementById('mainNav').classList.remove('active'); 
                } 
            }); 
        });
    </script>
    <!-- Lightbox -->
    <div id="lightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:1000;flex-direction:column;align-items:center;justify-content:center">
        <button onclick="closeLightbox()" style="position:absolute;top:1rem;right:1rem;background:none;border:none;color:white;font-size:2rem;cursor:pointer;z-index:1001;width:44px;height:44px;display:flex;align-items:center;justify-content:center">√ó</button>
        
        <div style="position:absolute;top:1rem;left:1rem;color:white;font-size:0.9rem">
            <span id="lightboxTitle" style="font-weight:600"></span>
            <span id="lightboxCounter" style="opacity:0.7;margin-left:1rem"></span>
        </div>
        
        <button id="lightboxPrev" onclick="prevPhoto()" style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.1);border:none;color:white;font-size:2rem;cursor:pointer;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background 0.2s">‚ùÆ</button>
        
        <div id="lightboxMedia" style="display:flex;align-items:center;justify-content:center;max-width:90vw;max-height:80vh"></div>
        
        <button id="lightboxNext" onclick="nextPhoto()" style="position:absolute;right:1rem;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.1);border:none;color:white;font-size:2rem;cursor:pointer;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background 0.2s">‚ùØ</button>
        
        <div id="lightboxCaption" style="position:absolute;bottom:2rem;color:white;text-align:center;max-width:80%;font-size:0.95rem"></div>
    </div>

<!-- COOKIES BANNER -->
    <div id="cookieBanner" style="display:none; position:fixed; bottom:0; left:0; right:0; background:#1a1a2e; color:white; padding:1rem 1.5rem; z-index:9999; box-shadow:0 -4px 20px rgba(0,0,0,0.3);">
        <div style="max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:1rem;">
            <div style="flex:1; min-width:280px;">
                <strong>üç™ Cookies</strong>
                <p style="margin:0.25rem 0 0; font-size:0.9rem; opacity:0.9;">T√°to str√°nka pou≈æ√≠va cookies pre spr√°vne fungovanie a anal√Ωzu n√°v≈°tevnosti. Pokraƒçovan√≠m s√∫hlas√≠te s ich pou≈æit√≠m.</p>
            </div>
            <div style="display:flex; gap:0.75rem; flex-wrap:wrap;">
                <button onclick="acceptCookies()" style="background:#2e7d32; color:white; border:none; padding:0.6rem 1.25rem; border-radius:6px; cursor:pointer; font-weight:600;">S√∫hlas√≠m</button>
                <button onclick="rejectCookies()" style="background:transparent; color:white; border:1px solid rgba(255,255,255,0.3); padding:0.6rem 1.25rem; border-radius:6px; cursor:pointer;">Len nevyhnutn√©</button>
            </div>
        </div>
    </div>
    
    <!-- GDPR MODAL -->
    <div id="gdprModal" class="modal">
        <div class="modal-content" style="max-width:600px;">
            <button class="modal-close" onclick="document.getElementById('gdprModal').classList.remove('active')">√ó</button>
            <h2 style="margin-bottom:1rem;">üîí Ochrana osobn√Ωch √∫dajov</h2>
            <div style="font-size:0.95rem; line-height:1.7;">
                <p><strong>Prev√°dzkovateƒæ:</strong> Jazdeck√Ω klub Zelen√° m√≠ƒæa Jaslovsk√© Bohunice, o.z.<br>
                IƒåO: 53536002<br>
                S√≠dlo: Nov√° ulica 297/41, 919 30 Jaslovsk√© Bohunice</p>
                
                <h4 style="margin:1.25rem 0 0.5rem;">Ak√© √∫daje sprac√∫vame?</h4>
                <p>Sprac√∫vame len √∫daje, ktor√© n√°m poskytnete cez kontaktn√Ω formul√°r (meno, email, telef√≥n, spr√°va) za √∫ƒçelom odpovede na v√°≈° dopyt.</p>
                
                <h4 style="margin:1.25rem 0 0.5rem;">Cookies</h4>
                <p>Pou≈æ√≠vame len nevyhnutn√© cookies pre fungovanie webu a analytick√© cookies pre meranie n√°v≈°tevnosti (anonymizovan√©).</p>
                
                <h4 style="margin:1.25rem 0 0.5rem;">Va≈°e pr√°va</h4>
                <p>M√°te pr√°vo na pr√≠stup k √∫dajom, ich opravu, vymazanie a n√°mietku proti sprac√∫vaniu. Kontaktujte n√°s na: <a href="mailto:apilera@apilera.com">apilera@apilera.com</a></p>
                
                <button onclick="document.getElementById('gdprModal').classList.remove('active')" style="margin-top:1.5rem; background:#2e7d32; color:white; border:none; padding:0.75rem 2rem; border-radius:8px; cursor:pointer; font-weight:600;">Rozumiem</button>
            </div>
        </div>
    </div>
    
    <script>
        // Cookies banner
        if (!localStorage.getItem('cookiesAccepted')) {
            document.getElementById('cookieBanner').style.display = 'block';
        }
        function acceptCookies() {
            localStorage.setItem('cookiesAccepted', 'all');
            document.getElementById('cookieBanner').style.display = 'none';
        }
        function rejectCookies() {
            localStorage.setItem('cookiesAccepted', 'essential');
            document.getElementById('cookieBanner').style.display = 'none';
        }
        function showGdpr() {
            document.getElementById('gdprModal').classList.add('active');
        }
    </script>
</body>
</html>
