<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | JK Zelen√° m√≠ƒæa</title>
    <link rel="icon" type="image/png" href="/assets/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #228B22; --primary-dark: #1a6b1a; --primary-light: #90EE90;
            --gold: #DAA520; --bg: #f4f6f9; --white: #fff; --dark: #1a1a1a;
            --gray: #666; --border: #e0e0e0; --success: #28a745; --danger: #dc3545;
            --warning: #ffc107; --info: #17a2b8; --sidebar-w: 250px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--dark); font-size: 14px; }

        /* Login */
        .login-page { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); padding: 1rem; }
        .login-box { background: var(--white); padding: 2.5rem; border-radius: 16px; width: 100%; max-width: 400px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); }
        .login-logo { text-align: center; margin-bottom: 2rem; }
        .login-logo img { height: 80px; }
        .login-title { text-align: center; font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
        .login-sub { text-align: center; color: var(--gray); margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.25rem; }
        .form-group label { display: block; font-weight: 500; margin-bottom: 0.5rem; font-size: 0.9rem; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.85rem 1rem; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem; font-family: inherit; transition: border 0.2s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--primary); }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; font-family: inherit; font-size: 0.95rem; }
        .btn-primary { background: var(--primary); color: var(--white); width: 100%; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-secondary { background: var(--bg); color: var(--dark); }
        .btn-secondary:hover { background: var(--border); }
        .btn-danger { background: var(--danger); color: var(--white); }
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.85rem; }
        .login-error { background: #ffe0e0; color: var(--danger); padding: 0.75rem 1rem; border-radius: 10px; margin-bottom: 1rem; display: none; text-align: center; }
        .login-hint { text-align: center; margin-top: 1.5rem; color: var(--gray); font-size: 0.9rem; }

        /* App Layout */
        .app { display: none; min-height: 100vh; }
        .app.active { display: flex; }

        /* Sidebar */
        .sidebar { width: var(--sidebar-w); background: var(--dark); color: var(--white); position: fixed; height: 100vh; overflow-y: auto; z-index: 100; }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 1rem; }
        .sidebar-header img { height: 40px; }
        .sidebar-header span { font-weight: 600; font-size: 1rem; }
        .sidebar-nav { padding: 1rem 0; }
        .nav-section { margin-bottom: 1.5rem; }
        .nav-title { font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; color: rgba(255,255,255,0.4); padding: 0 1.25rem; margin-bottom: 0.5rem; }
        .nav-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.8rem 1.25rem; color: rgba(255,255,255,0.7); cursor: pointer; transition: all 0.2s; border: none; background: none; width: 100%; text-align: left; font-size: 0.9rem; font-family: inherit; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: var(--white); }
        .nav-item.active { background: var(--primary); color: var(--white); border-left: 3px solid var(--primary-light); }
        .nav-item .icon { font-size: 1.1rem; width: 24px; }
        .nav-badge { margin-left: auto; background: var(--danger); color: var(--white); font-size: 0.7rem; padding: 0.15rem 0.5rem; border-radius: 50px; }
        .sidebar-footer { padding: 1rem 1.25rem; border-top: 1px solid rgba(255,255,255,0.1); position: absolute; bottom: 0; left: 0; right: 0; background: var(--dark); }
        .user-info { display: flex; align-items: center; gap: 0.75rem; }
        .user-avatar { width: 40px; height: 40px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; }
        .user-name { font-weight: 500; }
        .user-role { font-size: 0.75rem; color: rgba(255,255,255,0.5); }

        /* Main */
        .main { flex: 1; margin-left: var(--sidebar-w); }
        .header { background: var(--white); padding: 1rem 1.5rem; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 1px 3px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 50; }
        .header-left h1 { font-size: 1.25rem; font-weight: 600; }
        .header-right { display: flex; align-items: center; gap: 0.75rem; }
        .header-btn { width: 40px; height: 40px; border: none; background: var(--bg); border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; transition: background 0.2s; text-decoration: none; color: inherit; }
        .header-btn:hover { background: var(--border); }

        .content { padding: 1.5rem; }
        .page { display: none; }
        .page.active { display: block; }

        /* Stats */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--white); padding: 1.5rem; border-radius: 12px; display: flex; align-items: center; gap: 1rem; }
        .stat-icon { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        .stat-icon.green { background: rgba(34,139,34,0.1); }
        .stat-icon.blue { background: rgba(23,162,184,0.1); }
        .stat-icon.orange { background: rgba(255,193,7,0.1); }
        .stat-icon.red { background: rgba(220,53,69,0.1); }
        .stat-info h3 { font-size: 0.85rem; font-weight: 500; color: var(--gray); }
        .stat-value { font-size: 1.75rem; font-weight: 700; }

        /* Cards & Tables */
        .card { background: var(--white); border-radius: 12px; margin-bottom: 1.5rem; }
        .card-header { padding: 1rem 1.25rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-size: 1rem; font-weight: 600; }
        .card-body { padding: 1.25rem; }

        .table-wrap { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.9rem 1rem; text-align: left; }
        th { background: var(--bg); font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--gray); }
        td { border-bottom: 1px solid var(--border); }
        tr:last-child td { border-bottom: none; }
        tr:hover td { background: #f9f9f9; }

        .table-user { display: flex; align-items: center; gap: 0.75rem; }
        .table-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--primary); color: var(--white); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.8rem; }
        .table-name { font-weight: 500; }
        .table-sub { font-size: 0.8rem; color: var(--gray); }

        .badge { display: inline-block; padding: 0.3rem 0.75rem; border-radius: 50px; font-size: 0.75rem; font-weight: 500; }
        .badge-success { background: rgba(40,167,69,0.1); color: var(--success); }
        .badge-warning { background: rgba(255,193,7,0.1); color: #856404; }
        .badge-danger { background: rgba(220,53,69,0.1); color: var(--danger); }
        .badge-info { background: rgba(23,162,184,0.1); color: var(--info); }

        .actions { display: flex; gap: 0.5rem; }
        .action-btn { width: 32px; height: 32px; border: none; background: var(--bg); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .action-btn:hover { background: var(--primary); color: var(--white); }
        .action-btn.danger:hover { background: var(--danger); }

        /* Grid */
        .grid-2 { display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }

        /* Forms */
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-group textarea { min-height: 100px; resize: vertical; }

        /* Modal */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 1rem; }
        .modal-overlay.active { display: flex; }
        .modal { background: var(--white); border-radius: 16px; width: 100%; max-width: 550px; max-height: 90vh; overflow: hidden; }
        .modal-header { padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        .modal-header h3 { font-size: 1.1rem; }
        .modal-close { width: 36px; height: 36px; border: none; background: var(--bg); border-radius: 10px; cursor: pointer; font-size: 1.1rem; }
        .modal-close:hover { background: var(--danger); color: var(--white); }
        .modal-body { padding: 1.5rem; max-height: 60vh; overflow-y: auto; }
        .modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 0.75rem; }

        /* Toast */
        .toast { position: fixed; bottom: 1.5rem; right: 1.5rem; padding: 1rem 1.5rem; border-radius: 10px; color: var(--white); font-weight: 500; z-index: 9999; transform: translateY(100px); opacity: 0; transition: all 0.3s; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { background: var(--success); }
        .toast.error { background: var(--danger); }

        .empty { text-align: center; padding: 3rem; color: var(--gray); }

        /* Activity */
        .activity-item { display: flex; gap: 0.75rem; padding: 0.85rem 0; border-bottom: 1px solid var(--border); }
        .activity-item:last-child { border-bottom: none; }
        .activity-icon { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; }
        .activity-icon.green { background: rgba(34,139,34,0.1); }
        .activity-icon.blue { background: rgba(23,162,184,0.1); }
        .activity-icon.orange { background: rgba(255,193,7,0.1); }
        .activity-text { font-size: 0.9rem; }
        .activity-time { font-size: 0.75rem; color: var(--gray); }

        /* Feeding */
        .feeding-card { background: var(--bg); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
        .feeding-card h4 { margin-bottom: 0.75rem; font-size: 0.95rem; display: flex; align-items: center; gap: 0.5rem; }
        .feeding-row { display: flex; justify-content: space-between; padding: 0.4rem 0; border-bottom: 1px dashed var(--border); font-size: 0.9rem; }
        .feeding-row:last-child { border-bottom: none; }

        /* Responsive */
        @media (max-width: 1200px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } .grid-2 { grid-template-columns: 1fr; } }
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s; }
            .sidebar.open { transform: translateX(0); }
            .main { margin-left: 0; }
            .stats-grid { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
            .grid-3 { grid-template-columns: 1fr; }
            table { font-size: 0.8rem; }
            th, td { padding: 0.6rem 0.5rem; }
        }
    </style>
</head>
<body>
    <!-- Login -->
    <div class="login-page" id="loginPage">
        <div class="login-box">
            <div class="login-logo"><img src="/assets/logo.png" alt="Logo"></div>
            <h2 class="login-title">Admin Panel</h2>
            <p class="login-sub">Prihl√°ste sa do syst√©mu</p>
            <div class="login-error" id="loginError"></div>
            <form id="loginForm">
                <div class="form-group"><label>Email</label><input type="email" id="loginEmail" value="admin@jkzm.sk" required></div>
                <div class="form-group"><label>Heslo</label><input type="password" id="loginPassword" value="admin123" required></div>
                <button type="submit" class="btn btn-primary" id="loginBtn">Prihl√°si≈• sa</button>
            </form>
            <p class="login-hint">Demo: admin@jkzm.sk / admin123</p>
        </div>
    </div>

    <!-- App -->
    <div class="app" id="app">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header"><img src="/assets/logo.png" alt="Logo" style="filter:brightness(0) invert(1);"><span>Zelen√° m√≠ƒæa</span></div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-title">Prehƒæad</div>
                    <button class="nav-item active" data-page="dashboard"><span class="icon">üìä</span>Dashboard</button>
                </div>
                <div class="nav-section">
                    <div class="nav-title">Staj≈àa</div>
                    <button class="nav-item" data-page="horses"><span class="icon">üê¥</span>Kone<span class="nav-badge" id="badgeHorses">0</span></button>
                    <button class="nav-item" data-page="feeding"><span class="icon">ü•ï</span>K≈ïmenie</button>
                    <button class="nav-item" data-page="health"><span class="icon">üè•</span>Zdravie</button>
                </div>
                <div class="nav-section">
                    <div class="nav-title">ƒΩudia</div>
                    <button class="nav-item" data-page="riders"><span class="icon">üë•</span>Jazdci<span class="nav-badge" id="badgeRiders">0</span></button>
                    <button class="nav-item" data-page="trainers"><span class="icon">üë®‚Äçüè´</span>Tr√©neri</button>
                    <button class="nav-item" data-page="employees"><span class="icon">üë∑</span>Zamestnanci</button>
                </div>
                <div class="nav-section">
                    <div class="nav-title">Prev√°dzka</div>
                    <button class="nav-item" data-page="trainings"><span class="icon">üìà</span>Tr√©ningy</button>
                    <button class="nav-item" data-page="bookings"><span class="icon">üìã</span>Rezerv√°cie<span class="nav-badge" id="badgeBookings">0</span></button>
                    <button class="nav-item" data-page="payments"><span class="icon">üí≥</span>Platby</button>
                    <button class="nav-item" data-page="messages"><span class="icon">‚úâÔ∏è</span>Spr√°vy<span class="nav-badge" id="badgeMessages">0</span></button>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <div><div class="user-name" id="userName">Admin</div><div class="user-role">Administr√°tor</div></div>
                </div>
            </div>
        </aside>

        <main class="main">
            <header class="header">
                <div class="header-left"><h1 id="pageTitle">Dashboard</h1></div>
                <div class="header-right">
                    <a href="/" class="header-btn" title="Web">üåê</a>
                    <button class="header-btn" id="logoutBtn" title="Odhl√°si≈•">üö™</button>
                </div>
            </header>

            <div class="content">
                <!-- Dashboard -->
                <div class="page active" id="page-dashboard">
                    <div class="stats-grid">
                        <div class="stat-card"><div class="stat-icon green">üê¥</div><div class="stat-info"><h3>Kone</h3><div class="stat-value" id="statHorses">-</div></div></div>
                        <div class="stat-card"><div class="stat-icon blue">üë•</div><div class="stat-info"><h3>Jazdci</h3><div class="stat-value" id="statRiders">-</div></div></div>
                        <div class="stat-card"><div class="stat-icon orange">üìä</div><div class="stat-info"><h3>Tr√©ningy (mesiac)</h3><div class="stat-value" id="statTrainings">-</div></div></div>
                        <div class="stat-card"><div class="stat-icon red">üí∞</div><div class="stat-info"><h3>Tr≈æby (mesiac)</h3><div class="stat-value" id="statRevenue">-</div></div></div>
                    </div>
                    <div class="grid-2">
                        <div class="card">
                            <div class="card-header"><h3 class="card-title">Dne≈°n√© tr√©ningy</h3></div>
                            <div class="card-body"><div class="table-wrap"><table><thead><tr><th>ƒåas</th><th>Jazdec</th><th>K√¥≈à</th><th>Tr√©ner</th><th>Stav</th></tr></thead><tbody id="todayTrainings"></tbody></table></div></div>
                        </div>
                        <div class="card">
                            <div class="card-header"><h3 class="card-title">Posledn√° aktivita</h3></div>
                            <div class="card-body" id="activityList"></div>
                        </div>
                    </div>
                </div>

                <!-- Horses -->
                <div class="page" id="page-horses">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Zoznam kon√≠</h3><button class="btn btn-primary btn-sm" onclick="openModal('horseModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>K√¥≈à</th><th>Plemeno</th><th>Vek</th><th>Farba</th><th>√örove≈à</th><th>Stav</th><th></th></tr></thead><tbody id="horsesTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Riders -->
                <div class="page" id="page-riders">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Zoznam jazdcov</h3><button class="btn btn-primary btn-sm" onclick="openModal('riderModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>Jazdec</th><th>Kontakt</th><th>√örove≈à</th><th>Tr√©ningy</th><th>Stav</th><th></th></tr></thead><tbody id="ridersTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Trainers -->
                <div class="page" id="page-trainers">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Zoznam tr√©nerov</h3><button class="btn btn-primary btn-sm" onclick="openModal('trainerModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>Tr√©ner</th><th>≈†pecializ√°cia</th><th>Kontakt</th><th>Sadzba</th><th></th></tr></thead><tbody id="trainersTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Employees -->
                <div class="page" id="page-employees">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Zamestnanci</h3><button class="btn btn-primary btn-sm" onclick="openModal('employeeModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>Zamestnanec</th><th>Poz√≠cia</th><th>Kontakt</th><th>N√°stup</th><th></th></tr></thead><tbody id="employeesTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Trainings -->
                <div class="page" id="page-trainings">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Evidencia tr√©ningov</h3><button class="btn btn-primary btn-sm" onclick="openModal('trainingModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>D√°tum</th><th>ƒåas</th><th>Jazdec</th><th>K√¥≈à</th><th>Tr√©ner</th><th>Cena</th><th>Stav</th><th></th></tr></thead><tbody id="trainingsTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Feeding -->
                <div class="page" id="page-feeding">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">K≈ïmne pl√°ny</h3></div>
                        <div class="card-body" id="feedingList"></div>
                    </div>
                </div>

                <!-- Health -->
                <div class="page" id="page-health">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Zdravotn√© z√°znamy</h3></div>
                        <div class="card-body"><p class="empty">Zdravotn√© z√°znamy - pripravuje sa</p></div>
                    </div>
                </div>

                <!-- Bookings -->
                <div class="page" id="page-bookings">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Rezerv√°cie z webu</h3></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>Meno</th><th>Kontakt</th><th>Slu≈æba</th><th>D√°tum</th><th>Stav</th><th></th></tr></thead><tbody id="bookingsTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Payments -->
                <div class="page" id="page-payments">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Platby</h3><button class="btn btn-primary btn-sm" onclick="openModal('paymentModal')">+ Prida≈•</button></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>D√°tum</th><th>Jazdec</th><th>Suma</th><th>Sp√¥sob</th><th>Popis</th></tr></thead><tbody id="paymentsTable"></tbody></table></div></div>
                    </div>
                </div>

                <!-- Messages -->
                <div class="page" id="page-messages">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Spr√°vy z kontaktn√©ho formul√°ra</h3></div>
                        <div class="card-body"><div class="table-wrap"><table><thead><tr><th>Meno</th><th>Kontakt</th><th>Slu≈æba</th><th>Spr√°va</th><th>Stav</th><th></th></tr></thead><tbody id="messagesTable"></tbody></table></div></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="horseModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• ko≈àa</h3><button class="modal-close" onclick="closeModal('horseModal')">‚úï</button></div>
            <form id="horseForm">
                <div class="modal-body">
                    <div class="form-group"><label>Meno *</label><input type="text" name="name" required></div>
                    <div class="form-row">
                        <div class="form-group"><label>Plemeno</label><input type="text" name="breed"></div>
                        <div class="form-group"><label>Farba</label><input type="text" name="color"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum narodenia</label><input type="date" name="birth_date"></div>
                        <div class="form-group"><label>V√Ω≈°ka (cm)</label><input type="number" name="height"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Pohlavie</label><select name="gender"><option value="">-</option><option value="stallion">≈Ωrebec</option><option value="mare">Kobyla</option><option value="gelding">Valach</option></select></div>
                        <div class="form-group"><label>√örove≈à</label><select name="level"><option value="beginner">Zaƒçiatoƒçn√≠ci</option><option value="intermediate">Pokroƒçil√≠</option><option value="advanced">Sk√∫sen√≠</option><option value="children">Deti</option></select></div>
                    </div>
                    <div class="form-group"><label>Pozn√°mky</label><textarea name="notes"></textarea></div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('horseModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="riderModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• jazdca</h3><button class="modal-close" onclick="closeModal('riderModal')">‚úï</button></div>
            <form id="riderForm">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group"><label>Meno *</label><input type="text" name="first_name" required></div>
                        <div class="form-group"><label>Priezvisko *</label><input type="text" name="last_name" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Email</label><input type="email" name="email"></div>
                        <div class="form-group"><label>Telef√≥n</label><input type="tel" name="phone"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum narodenia</label><input type="date" name="birth_date"></div>
                        <div class="form-group"><label>√örove≈à</label><select name="level"><option value="beginner">Zaƒçiatoƒçn√≠k</option><option value="intermediate">Pokroƒçil√Ω</option><option value="advanced">Sk√∫sen√Ω</option></select></div>
                    </div>
                    <div class="form-group"><label>Pozn√°mky</label><textarea name="notes"></textarea></div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('riderModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="trainerModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• tr√©nera</h3><button class="modal-close" onclick="closeModal('trainerModal')">‚úï</button></div>
            <form id="trainerForm">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group"><label>Meno *</label><input type="text" name="first_name" required></div>
                        <div class="form-group"><label>Priezvisko *</label><input type="text" name="last_name" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Email</label><input type="email" name="email"></div>
                        <div class="form-group"><label>Telef√≥n</label><input type="tel" name="phone"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>≈†pecializ√°cia</label><input type="text" name="specialization"></div>
                        <div class="form-group"><label>Hodinov√° sadzba (‚Ç¨)</label><input type="number" name="hourly_rate" step="0.01"></div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('trainerModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="employeeModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• zamestnanca</h3><button class="modal-close" onclick="closeModal('employeeModal')">‚úï</button></div>
            <form id="employeeForm">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group"><label>Meno *</label><input type="text" name="first_name" required></div>
                        <div class="form-group"><label>Priezvisko *</label><input type="text" name="last_name" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Email</label><input type="email" name="email"></div>
                        <div class="form-group"><label>Telef√≥n</label><input type="tel" name="phone"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Poz√≠cia</label><input type="text" name="position"></div>
                        <div class="form-group"><label>D√°tum n√°stupu</label><input type="date" name="hire_date"></div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('employeeModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="trainingModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• tr√©ning</h3><button class="modal-close" onclick="closeModal('trainingModal')">‚úï</button></div>
            <form id="trainingForm">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum *</label><input type="date" name="scheduled_date" required></div>
                        <div class="form-group"><label>ƒåas *</label><input type="time" name="scheduled_time" required></div>
                    </div>
                    <div class="form-group"><label>Jazdec</label><select name="rider_id" id="selRider"></select></div>
                    <div class="form-group"><label>K√¥≈à</label><select name="horse_id" id="selHorse"></select></div>
                    <div class="form-group"><label>Tr√©ner</label><select name="trainer_id" id="selTrainer"></select></div>
                    <div class="form-row">
                        <div class="form-group"><label>Trvanie (min)</label><input type="number" name="duration" value="60"></div>
                        <div class="form-group"><label>Cena (‚Ç¨)</label><input type="number" name="price" step="0.01"></div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('trainingModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="paymentModal">
        <div class="modal">
            <div class="modal-header"><h3>Prida≈• platbu</h3><button class="modal-close" onclick="closeModal('paymentModal')">‚úï</button></div>
            <form id="paymentForm">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum *</label><input type="date" name="payment_date" required></div>
                        <div class="form-group"><label>Suma (‚Ç¨) *</label><input type="number" name="amount" step="0.01" required></div>
                    </div>
                    <div class="form-group"><label>Jazdec</label><select name="rider_id" id="selPaymentRider"></select></div>
                    <div class="form-group"><label>Sp√¥sob platby</label><select name="payment_method"><option value="cash">Hotovos≈•</option><option value="card">Karta</option><option value="transfer">Prevod</option></select></div>
                    <div class="form-group"><label>Popis</label><input type="text" name="description"></div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" onclick="closeModal('paymentModal')">Zru≈°i≈•</button><button type="submit" class="btn btn-primary">Ulo≈æi≈•</button></div>
            </form>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        let token = localStorage.getItem('jkzm_token');
        let user = JSON.parse(localStorage.getItem('jkzm_user') || 'null');

        async function api(endpoint, options = {}) {
            const headers = { 'Content-Type': 'application/json' };
            if (token) headers['Authorization'] = 'Bearer ' + token;
            const res = await fetch('/api' + endpoint, { ...options, headers });
            if (res.status === 401) { logout(); throw new Error('Unauthorized'); }
            return res.json();
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('loginBtn');
            const error = document.getElementById('loginError');
            btn.disabled = true; btn.textContent = 'Prihlasujem...'; error.style.display = 'none';
            try {
                const res = await fetch('/api/auth/login', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: document.getElementById('loginEmail').value, password: document.getElementById('loginPassword').value })
                });
                const data = await res.json();
                if (res.ok) {
                    token = data.token; user = data.user;
                    localStorage.setItem('jkzm_token', token);
                    localStorage.setItem('jkzm_user', JSON.stringify(user));
                    showApp();
                } else { error.textContent = data.error || 'Chyba prihl√°senia'; error.style.display = 'block'; }
            } catch (err) { error.textContent = 'Chyba pripojenia'; error.style.display = 'block'; }
            btn.disabled = false; btn.textContent = 'Prihl√°si≈• sa';
        });

        function logout() {
            token = null; user = null;
            localStorage.removeItem('jkzm_token'); localStorage.removeItem('jkzm_user');
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('app').classList.remove('active');
        }
        document.getElementById('logoutBtn').addEventListener('click', logout);

        function showApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('app').classList.add('active');
            document.getElementById('userName').textContent = user?.name || 'Admin';
            document.getElementById('userAvatar').textContent = (user?.name || 'A')[0].toUpperCase();
            loadDashboard();
        }

        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById('page-' + item.dataset.page).classList.add('active');
                document.getElementById('pageTitle').textContent = item.textContent.trim();
                loadPage(item.dataset.page);
            });
        });

        function loadPage(page) {
            const loaders = { dashboard: loadDashboard, horses: loadHorses, riders: loadRiders, trainers: loadTrainers, employees: loadEmployees, feeding: loadFeeding, trainings: loadTrainings, bookings: loadBookings, payments: loadPayments, messages: loadMessages };
            if (loaders[page]) loaders[page]();
        }

        // Dashboard
        async function loadDashboard() {
            try {
                const [stats, today, activity] = await Promise.all([api('/dashboard/stats'), api('/dashboard/today'), api('/dashboard/activity')]);
                document.getElementById('statHorses').textContent = stats.horses?.total || 0;
                document.getElementById('statRiders').textContent = stats.riders?.total || 0;
                document.getElementById('statTrainings').textContent = stats.trainings?.thisMonth || 0;
                document.getElementById('statRevenue').textContent = '‚Ç¨' + (stats.revenue?.thisMonth || 0);
                document.getElementById('badgeHorses').textContent = stats.horses?.total || 0;
                document.getElementById('badgeRiders').textContent = stats.riders?.total || 0;
                document.getElementById('badgeBookings').textContent = stats.pendingBookings || 0;
                document.getElementById('badgeMessages').textContent = stats.newMessages || 0;

                document.getElementById('todayTrainings').innerHTML = today.length ? today.map(t => `<tr><td>${t.scheduled_time?.slice(0,5)||'-'}</td><td>${t.rider_name||'-'}</td><td>${t.horse_name||'-'}</td><td>${t.trainer_name||'-'}</td><td><span class="badge ${t.status==='completed'?'badge-success':'badge-warning'}">${t.status==='completed'?'Hotovo':'ƒåak√°'}</span></td></tr>`).join('') : '<tr><td colspan="5" class="empty">Dnes ≈æiadne tr√©ningy</td></tr>';

                document.getElementById('activityList').innerHTML = activity.length ? activity.map(a => `<div class="activity-item"><div class="activity-icon ${a.type==='training'?'green':a.type==='booking'?'blue':'orange'}">${a.type==='training'?'‚úì':a.type==='booking'?'üìÖ':'‚úâÔ∏è'}</div><div><p class="activity-text">${a.message}</p><div class="activity-time">${formatTime(a.time)}</div></div></div>`).join('') : '<p class="empty">≈Ωiadna aktivita</p>';
            } catch (e) { console.error(e); }
        }

        // Horses
        async function loadHorses() {
            try {
                const horses = await api('/horses');
                const levels = { beginner: 'Zaƒçiatoƒçn√≠ci', intermediate: 'Pokroƒçil√≠', advanced: 'Sk√∫sen√≠', children: 'Deti' };
                document.getElementById('horsesTable').innerHTML = horses.length ? horses.map(h => `<tr><td><div class="table-user"><div class="table-avatar">üê¥</div><span class="table-name">${h.name}</span></div></td><td>${h.breed||'-'}</td><td>${h.birth_date ? calcAge(h.birth_date) + ' r.' : '-'}</td><td>${h.color||'-'}</td><td>${levels[h.level]||h.level||'-'}</td><td><span class="badge ${h.status==='active'?'badge-success':'badge-warning'}">${h.status==='active'?'Akt√≠vny':'Neakt√≠vny'}</span></td><td><div class="actions"><button class="action-btn danger" onclick="deleteHorse(${h.id})">üóëÔ∏è</button></div></td></tr>`).join('') : '<tr><td colspan="7" class="empty">≈Ωiadne kone</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Riders
        async function loadRiders() {
            try {
                const riders = await api('/riders');
                const levels = { beginner: 'Zaƒçiatoƒçn√≠k', intermediate: 'Pokroƒçil√Ω', advanced: 'Sk√∫sen√Ω' };
                document.getElementById('ridersTable').innerHTML = riders.length ? riders.map(r => `<tr><td><div class="table-user"><div class="table-avatar">${r.first_name[0]}${r.last_name[0]}</div><div><span class="table-name">${r.first_name} ${r.last_name}</span><div class="table-sub">${r.email||''}</div></div></div></td><td>${r.phone||'-'}</td><td>${levels[r.level]||r.level||'-'}</td><td>${r.total_trainings||0}</td><td><span class="badge ${r.status==='active'?'badge-success':'badge-warning'}">${r.status==='active'?'Akt√≠vny':'Neakt√≠vny'}</span></td><td><div class="actions"><button class="action-btn danger" onclick="deleteRider(${r.id})">üóëÔ∏è</button></div></td></tr>`).join('') : '<tr><td colspan="6" class="empty">≈Ωiadni jazdci</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Trainers
        async function loadTrainers() {
            try {
                const trainers = await api('/trainers');
                document.getElementById('trainersTable').innerHTML = trainers.length ? trainers.map(t => `<tr><td><div class="table-user"><div class="table-avatar">${t.first_name[0]}${t.last_name[0]}</div><span class="table-name">${t.first_name} ${t.last_name}</span></div></td><td>${t.specialization||'-'}</td><td>${t.email||'-'}<br><small>${t.phone||''}</small></td><td>‚Ç¨${t.hourly_rate||0}/h</td><td><div class="actions"><button class="action-btn danger" onclick="deleteTrainer(${t.id})">üóëÔ∏è</button></div></td></tr>`).join('') : '<tr><td colspan="5" class="empty">≈Ωiadni tr√©neri</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Employees
        async function loadEmployees() {
            try {
                const employees = await api('/employees');
                document.getElementById('employeesTable').innerHTML = employees.length ? employees.map(e => `<tr><td><div class="table-user"><div class="table-avatar">${e.first_name[0]}${e.last_name[0]}</div><span class="table-name">${e.first_name} ${e.last_name}</span></div></td><td>${e.position||'-'}</td><td>${e.email||'-'}<br><small>${e.phone||''}</small></td><td>${e.hire_date||'-'}</td><td><div class="actions"><button class="action-btn danger" onclick="deleteEmployee(${e.id})">üóëÔ∏è</button></div></td></tr>`).join('') : '<tr><td colspan="5" class="empty">≈Ωiadni zamestnanci</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Trainings
        async function loadTrainings() {
            try {
                const trainings = await api('/trainings');
                document.getElementById('trainingsTable').innerHTML = trainings.length ? trainings.map(t => `<tr><td>${t.scheduled_date}</td><td>${t.scheduled_time?.slice(0,5)||'-'}</td><td>${t.rider_name||'-'}</td><td>${t.horse_name||'-'}</td><td>${t.trainer_name||'-'}</td><td>‚Ç¨${t.price||0}</td><td><span class="badge ${t.status==='completed'?'badge-success':'badge-warning'}">${t.status==='completed'?'Hotovo':'ƒåak√°'}</span></td><td><div class="actions"><button class="action-btn" onclick="completeTraining(${t.id})">‚úì</button></div></td></tr>`).join('') : '<tr><td colspan="8" class="empty">≈Ωiadne tr√©ningy</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Feeding
        async function loadFeeding() {
            try {
                const schedules = await api('/feeding');
                const grouped = {};
                schedules.forEach(s => { if (!grouped[s.horse_name]) grouped[s.horse_name] = []; grouped[s.horse_name].push(s); });
                document.getElementById('feedingList').innerHTML = Object.entries(grouped).length ? Object.entries(grouped).map(([horse, scheds]) => `<div class="feeding-card"><h4>üê¥ ${horse}</h4>${scheds.map(s => `<div style="margin-bottom:0.5rem;"><strong>${s.time_of_day==='morning'?'‚òÄÔ∏è R√°no':s.time_of_day==='noon'?'üå§Ô∏è Obed':'üåô Veƒçer'} (${s.feed_time?.slice(0,5)||''})</strong>${(s.items||[]).map(i => `<div class="feeding-row"><span>${i.feed_type}</span><span>${i.amount} ${i.unit}</span></div>`).join('')}</div>`).join('')}</div>`).join('') : '<p class="empty">≈Ωiadne k≈ïmne pl√°ny</p>';
            } catch (e) { console.error(e); }
        }

        // Bookings
        async function loadBookings() {
            try {
                const bookings = await api('/bookings');
                document.getElementById('bookingsTable').innerHTML = bookings.length ? bookings.map(b => `<tr><td>${b.name}</td><td>${b.email}<br><small>${b.phone||''}</small></td><td>${b.service||'-'}</td><td>${b.preferred_date||'-'}</td><td><span class="badge ${b.status==='confirmed'?'badge-success':'badge-warning'}">${b.status==='confirmed'?'Potvrden√©':'ƒåak√°'}</span></td><td><div class="actions"><button class="action-btn" onclick="confirmBooking(${b.id})">‚úì</button></div></td></tr>`).join('') : '<tr><td colspan="6" class="empty">≈Ωiadne rezerv√°cie</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Payments
        async function loadPayments() {
            try {
                const payments = await api('/payments');
                const methods = { cash: 'Hotovos≈•', card: 'Karta', transfer: 'Prevod' };
                document.getElementById('paymentsTable').innerHTML = payments.length ? payments.map(p => `<tr><td>${p.payment_date}</td><td>${p.rider_name||'-'}</td><td><strong>‚Ç¨${p.amount}</strong></td><td>${methods[p.payment_method]||p.payment_method||'Hotovos≈•'}</td><td>${p.description||'-'}</td></tr>`).join('') : '<tr><td colspan="5" class="empty">≈Ωiadne platby</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Messages
        async function loadMessages() {
            try {
                const messages = await api('/contact');
                document.getElementById('messagesTable').innerHTML = messages.length ? messages.map(m => `<tr><td>${m.name}</td><td>${m.email}<br><small>${m.phone||''}</small></td><td>${m.service||'-'}</td><td style="max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${m.message||'-'}</td><td><span class="badge ${m.status==='new'?'badge-warning':'badge-success'}">${m.status==='new'?'Nov√°':'Preƒç√≠tan√©'}</span></td><td><div class="actions"><button class="action-btn" onclick="markRead(${m.id})">‚úì</button></div></td></tr>`).join('') : '<tr><td colspan="6" class="empty">≈Ωiadne spr√°vy</td></tr>';
            } catch (e) { console.error(e); }
        }

        // Form submissions
        document.getElementById('horseForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/horses', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('horseModal'); showToast('K√¥≈à pridan√Ω'); loadHorses(); loadDashboard(); e.target.reset(); });
        document.getElementById('riderForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/riders', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('riderModal'); showToast('Jazdec pridan√Ω'); loadRiders(); loadDashboard(); e.target.reset(); });
        document.getElementById('trainerForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/trainers', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('trainerModal'); showToast('Tr√©ner pridan√Ω'); loadTrainers(); e.target.reset(); });
        document.getElementById('employeeForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/employees', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('employeeModal'); showToast('Zamestnanec pridan√Ω'); loadEmployees(); e.target.reset(); });
        document.getElementById('trainingForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/trainings', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('trainingModal'); showToast('Tr√©ning pridan√Ω'); loadTrainings(); loadDashboard(); e.target.reset(); });
        document.getElementById('paymentForm').addEventListener('submit', async (e) => { e.preventDefault(); await api('/payments', { method: 'POST', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) }); closeModal('paymentModal'); showToast('Platba pridan√°'); loadPayments(); loadDashboard(); e.target.reset(); });

        // Actions
        async function deleteHorse(id) { if (confirm('Vymaza≈• ko≈àa?')) { await api('/horses/' + id, { method: 'DELETE' }); showToast('Vymazan√©'); loadHorses(); loadDashboard(); } }
        async function deleteRider(id) { if (confirm('Vymaza≈• jazdca?')) { await api('/riders/' + id, { method: 'DELETE' }); showToast('Vymazan√©'); loadRiders(); loadDashboard(); } }
        async function deleteTrainer(id) { if (confirm('Vymaza≈• tr√©nera?')) { await api('/trainers', { method: 'DELETE' }); showToast('Vymazan√©'); loadTrainers(); } }
        async function deleteEmployee(id) { if (confirm('Vymaza≈• zamestnanca?')) { await api('/employees', { method: 'DELETE' }); showToast('Vymazan√©'); loadEmployees(); } }
        async function confirmBooking(id) { await api('/bookings/' + id + '/status', { method: 'PATCH', body: JSON.stringify({ status: 'confirmed' }) }); showToast('Potvrden√©'); loadBookings(); loadDashboard(); }
        async function markRead(id) { await api('/contact/' + id + '/status', { method: 'PATCH', body: JSON.stringify({ status: 'read' }) }); showToast('Oznaƒçen√© ako preƒç√≠tan√©'); loadMessages(); loadDashboard(); }
        async function completeTraining(id) { /* TODO */ showToast('Funkcia sa pripravuje'); }

        // Modals
        function openModal(id) { 
            document.getElementById(id).classList.add('active'); 
            if (id === 'trainingModal' || id === 'paymentModal') loadSelects();
        }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }
        document.querySelectorAll('.modal-overlay').forEach(m => m.addEventListener('click', e => { if (e.target === m) m.classList.remove('active'); }));

        async function loadSelects() {
            try {
                const [horses, riders, trainers] = await Promise.all([api('/horses'), api('/riders'), api('/trainers')]);
                document.getElementById('selHorse').innerHTML = '<option value="">-</option>' + horses.map(h => `<option value="${h.id}">${h.name}</option>`).join('');
                document.getElementById('selRider').innerHTML = '<option value="">-</option>' + riders.map(r => `<option value="${r.id}">${r.first_name} ${r.last_name}</option>`).join('');
                document.getElementById('selTrainer').innerHTML = '<option value="">-</option>' + trainers.map(t => `<option value="${t.id}">${t.first_name} ${t.last_name}</option>`).join('');
                document.getElementById('selPaymentRider').innerHTML = '<option value="">-</option>' + riders.map(r => `<option value="${r.id}">${r.first_name} ${r.last_name}</option>`).join('');
            } catch (e) {}
        }

        // Utils
        function showToast(msg) { const t = document.getElementById('toast'); t.textContent = msg; t.className = 'toast success show'; setTimeout(() => t.classList.remove('show'), 3000); }
        function formatTime(d) { if (!d) return ''; const diff = (Date.now() - new Date(d)) / 60000; return diff < 60 ? Math.floor(diff) + ' min' : diff < 1440 ? Math.floor(diff/60) + ' hod' : new Date(d).toLocaleDateString('sk'); }
        function calcAge(d) { return new Date().getFullYear() - new Date(d).getFullYear(); }

        // Init
        if (token && user) showApp();
    </script>
</body>
</html>
