<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | JK Zelen√° m√≠ƒæa - Profesion√°lny syst√©m</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--primary:#228B22;--primary-dark:#1a6b1a;--primary-light:#90EE90;--danger:#dc3545;--warning:#ffc107;--info:#17a2b8;--success:#28a745;--dark:#1a1a1a;--gray:#6c757d;--gray-light:#e9ecef;--light:#f8f9fa;--white:#fff;--shadow:0 2px 10px rgba(0,0,0,0.1);--radius:12px}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--light);min-height:100vh;display:flex}
        .sidebar{width:280px;background:linear-gradient(180deg,var(--dark) 0%,#2d2d2d 100%);color:var(--white);padding:1.5rem;position:fixed;height:100vh;overflow-y:auto;z-index:100}
        .sidebar-header{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid rgba(255,255,255,0.1)}
        .sidebar-header img{height:50px;filter:brightness(0) invert(1)}.sidebar-header h2{font-size:1rem;font-weight:600}
        .sidebar-header small{display:block;font-size:0.75rem;opacity:0.7;margin-top:0.25rem}
        .nav-section{margin-bottom:1.5rem}.nav-section-title{font-size:0.7rem;text-transform:uppercase;letter-spacing:1px;opacity:0.5;margin-bottom:0.75rem;padding-left:0.5rem}
        .nav-item{display:flex;align-items:center;gap:0.75rem;padding:0.75rem 1rem;border-radius:var(--radius);cursor:pointer;transition:all 0.2s;margin-bottom:0.25rem;font-size:0.9rem}
        .nav-item:hover{background:rgba(255,255,255,0.1)}.nav-item.active{background:var(--primary);font-weight:500}
        .nav-item .icon{width:20px;text-align:center;font-size:1rem}.nav-item .badge{margin-left:auto;background:var(--danger);padding:0.15rem 0.5rem;border-radius:10px;font-size:0.7rem;font-weight:600}
        .main{margin-left:280px;flex:1;padding:2rem;min-height:100vh}
        .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}
        .header h1{font-size:1.75rem;color:var(--dark)}.header-actions{display:flex;gap:1rem;align-items:center}
        .btn{display:inline-flex;align-items:center;gap:0.5rem;padding:0.6rem 1.25rem;border-radius:var(--radius);font-weight:500;cursor:pointer;transition:all 0.2s;border:none;font-family:inherit;font-size:0.9rem}
        .btn-primary{background:var(--primary);color:var(--white)}.btn-primary:hover{background:var(--primary-dark)}
        .btn-outline{background:transparent;border:2px solid var(--primary);color:var(--primary)}.btn-outline:hover{background:var(--primary);color:var(--white)}
        .btn-danger{background:var(--danger);color:var(--white)}.btn-warning{background:var(--warning);color:var(--dark)}
        .btn-sm{padding:0.4rem 0.75rem;font-size:0.8rem}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem}
        .stat-card{background:var(--white);padding:1.5rem;border-radius:var(--radius);box-shadow:var(--shadow)}
        .stat-card .icon{width:50px;height:50px;border-radius:var(--radius);display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1rem}
        .stat-card .icon.green{background:rgba(34,139,34,0.1);color:var(--primary)}
        .stat-card .icon.blue{background:rgba(23,162,184,0.1);color:var(--info)}
        .stat-card .icon.orange{background:rgba(255,193,7,0.1);color:#e67e00}
        .stat-card .icon.red{background:rgba(220,53,69,0.1);color:var(--danger)}
        .stat-card .value{font-size:2rem;font-weight:700;color:var(--dark)}.stat-card .label{color:var(--gray);font-size:0.85rem}
        .card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:1.5rem}
        .card-header{padding:1.25rem 1.5rem;border-bottom:1px solid var(--gray-light);display:flex;justify-content:space-between;align-items:center}
        .card-header h3{font-size:1.1rem;font-weight:600;color:var(--dark)}.card-body{padding:1.5rem}
        .table{width:100%;border-collapse:collapse}.table th,.table td{padding:0.875rem 1rem;text-align:left;border-bottom:1px solid var(--gray-light)}
        .table th{font-weight:600;color:var(--gray);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.5px;background:var(--light)}
        .table tbody tr:hover{background:var(--light)}.table tbody tr:last-child td{border-bottom:none}
        .badge{display:inline-block;padding:0.3rem 0.75rem;border-radius:20px;font-size:0.75rem;font-weight:500}
        .badge-success{background:rgba(40,167,69,0.1);color:var(--success)}
        .badge-warning{background:rgba(255,193,7,0.2);color:#856404}
        .badge-danger{background:rgba(220,53,69,0.1);color:var(--danger)}
        .badge-info{background:rgba(23,162,184,0.1);color:var(--info)}
        .badge-gray{background:var(--gray-light);color:var(--gray)}
        .avatar{width:40px;height:40px;border-radius:50%;background:var(--primary);color:var(--white);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:0.9rem}
        .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;padding:1rem}
        .modal.active{display:flex}.modal-content{background:var(--white);border-radius:var(--radius);width:100%;max-width:700px;max-height:90vh;overflow-y:auto}
        .modal-header{padding:1.25rem 1.5rem;border-bottom:1px solid var(--gray-light);display:flex;justify-content:space-between;align-items:center}
        .modal-header h3{font-size:1.2rem}.modal-close{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--gray)}
        .modal-body{padding:1.5rem}.modal-footer{padding:1rem 1.5rem;border-top:1px solid var(--gray-light);display:flex;justify-content:flex-end;gap:0.75rem}
        .form-row{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.form-group{margin-bottom:1rem}
        .form-group label{display:block;margin-bottom:0.5rem;font-weight:500;color:var(--dark);font-size:0.9rem}
        .form-group label small{font-weight:400;color:var(--gray)}
        .form-control{width:100%;padding:0.7rem 1rem;border:2px solid var(--gray-light);border-radius:var(--radius);font-family:inherit;font-size:0.9rem;transition:border 0.2s}
        .form-control:focus{outline:none;border-color:var(--primary)}select.form-control{cursor:pointer}textarea.form-control{resize:vertical;min-height:80px}
        .tabs{display:flex;gap:0;border-bottom:2px solid var(--gray-light);margin-bottom:1.5rem}
        .tab{padding:0.875rem 1.5rem;cursor:pointer;color:var(--gray);font-weight:500;border-bottom:2px solid transparent;margin-bottom:-2px;transition:all 0.2s;font-size:0.9rem}
        .tab:hover{color:var(--primary)}.tab.active{color:var(--primary);border-bottom-color:var(--primary)}
        .alert{padding:1rem 1.25rem;border-radius:var(--radius);margin-bottom:1rem;display:flex;align-items:center;gap:0.75rem}
        .alert-warning{background:rgba(255,193,7,0.15);color:#856404;border-left:4px solid var(--warning)}
        .alert-danger{background:rgba(220,53,69,0.1);color:var(--danger);border-left:4px solid var(--danger)}
        .alert-info{background:rgba(23,162,184,0.1);color:var(--info);border-left:4px solid var(--info)}
        .alert-success{background:rgba(40,167,69,0.1);color:var(--success);border-left:4px solid var(--success)}
        .toast{position:fixed;bottom:2rem;right:2rem;background:var(--dark);color:var(--white);padding:1rem 1.5rem;border-radius:var(--radius);transform:translateY(150%);opacity:0;transition:all 0.3s;z-index:9999}
        .toast.show{transform:translateY(0);opacity:1}.toast.success{background:var(--success)}.toast.error{background:var(--danger)}
        .section{display:none}.section.active{display:block}
        .search-box{position:relative}.search-box input{padding-left:2.5rem;width:250px}
        .search-box::before{content:'üîç';position:absolute;left:0.75rem;top:50%;transform:translateY(-50%);font-size:0.9rem}
        .vet-timeline{position:relative;padding-left:2rem}.vet-timeline::before{content:'';position:absolute;left:0.5rem;top:0;bottom:0;width:2px;background:var(--gray-light)}
        .vet-item{position:relative;margin-bottom:1.5rem;padding:1rem;background:var(--light);border-radius:var(--radius)}
        .vet-item::before{content:'';position:absolute;left:-1.65rem;top:1rem;width:12px;height:12px;border-radius:50%;background:var(--primary);border:2px solid var(--white)}
        .vet-item.overdue::before{background:var(--danger)}.vet-item.soon::before{background:var(--warning)}
        .vet-item-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem}
        .vet-item-title{font-weight:600;color:var(--dark)}.vet-item-date{font-size:0.85rem;color:var(--gray)}
        .quick-actions{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:2rem}
        .quick-action{background:var(--white);padding:1.25rem;border-radius:var(--radius);text-align:center;cursor:pointer;transition:all 0.2s;box-shadow:var(--shadow)}
        .quick-action:hover{transform:translateY(-3px);box-shadow:0 5px 20px rgba(0,0,0,0.15)}
        .quick-action .icon{font-size:2rem;margin-bottom:0.5rem}.quick-action span{font-size:0.85rem;color:var(--gray)}
        .notifications-list{max-height:400px;overflow-y:auto}
        .notification-item{display:flex;gap:1rem;padding:1rem;border-bottom:1px solid var(--gray-light);transition:background 0.2s}
        .notification-item:hover{background:var(--light)}.notification-item:last-child{border-bottom:none}
        .notification-icon{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .notification-icon.warning{background:rgba(255,193,7,0.2)}.notification-icon.danger{background:rgba(220,53,69,0.1)}
        .notification-icon.info{background:rgba(23,162,184,0.1)}
        .notification-content{flex:1}.notification-title{font-weight:500;color:var(--dark);margin-bottom:0.25rem}
        .notification-text{font-size:0.85rem;color:var(--gray)}.notification-time{font-size:0.75rem;color:var(--gray)}
        .progress-bar{height:8px;background:var(--gray-light);border-radius:4px;overflow:hidden}
        .progress-bar .fill{height:100%;border-radius:4px;transition:width 0.3s}
        .login-page{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--primary),var(--primary-dark))}
        .login-box{background:var(--white);padding:2.5rem;border-radius:var(--radius);width:100%;max-width:400px;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
        .login-box h2{text-align:center;margin-bottom:2rem;color:var(--dark)}.login-box img{display:block;margin:0 auto 1.5rem;height:80px}
        @media(max-width:1024px){.sidebar{transform:translateX(-100%);transition:transform 0.3s}.sidebar.open{transform:translateX(0)}.main{margin-left:0}}
        .fieldset{border:1px solid var(--gray-light);border-radius:var(--radius);padding:1rem;margin-bottom:1rem}
        .fieldset legend{padding:0 0.5rem;font-weight:600;color:var(--primary);font-size:0.9rem}
        .horse-card{display:grid;grid-template-columns:100px 1fr;gap:1rem;padding:1rem;border:1px solid var(--gray-light);border-radius:var(--radius);margin-bottom:1rem}
        .horse-card img{width:100px;height:100px;object-fit:cover;border-radius:var(--radius)}
        .horse-card-info h4{margin-bottom:0.25rem}.horse-card-info p{font-size:0.85rem;color:var(--gray)}
        .horse-card-badges{display:flex;gap:0.5rem;flex-wrap:wrap;margin-top:0.5rem}
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="login-page">
        <div class="login-box">
            <img src="/assets/logo.png" alt="Logo">
            <h2>Admin Panel</h2>
            <p style="text-align:center;color:var(--gray);margin-bottom:1.5rem">Jazdeck√Ω klub Zelen√° m√≠ƒæa<br><small>Profesion√°lny syst√©m podƒæa SJF/≈†VPS/FEI</small></p>
            <form id="loginForm">
                <div class="form-group"><label>Email</label><input type="email" class="form-control" id="loginEmail" value="admin@jkzm.sk" required></div>
                <div class="form-group"><label>Heslo</label><input type="password" class="form-control" id="loginPassword" value="admin123" required></div>
                <button type="submit" class="btn btn-primary" style="width:100%;padding:0.875rem;margin-top:0.5rem">Prihl√°si≈• sa</button>
            </form>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="app" style="display:none;width:100%">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/assets/logo.png" alt="Logo">
                <div><h2>JK Zelen√° m√≠ƒæa</h2><small>Admin Panel PRO</small></div>
            </div>
            <nav>
                <div class="nav-section">
                    <div class="nav-section-title">Prehƒæad</div>
                    <div class="nav-item active" data-section="dashboard"><span class="icon">üìä</span>Dashboard<span class="badge" id="alertBadge">0</span></div>
                    <div class="nav-item" data-section="notifications"><span class="icon">üîî</span>Upozornenia</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Evidencia</div>
                    <div class="nav-item" data-section="horses"><span class="icon">üê¥</span>Kone</div>
                    <div class="nav-item" data-section="riders"><span class="icon">üèá</span>Jazdci</div>
                    <div class="nav-item" data-section="trainers"><span class="icon">üë®‚Äçüè´</span>Tr√©neri</div>
                    <div class="nav-item" data-section="employees"><span class="icon">üë∑</span>Zamestnanci</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Prev√°dzka</div>
                    <div class="nav-item" data-section="trainings"><span class="icon">üìÖ</span>Tr√©ningy</div>
                    <div class="nav-item" data-section="vet"><span class="icon">üè•</span>Veterin√°rne z√°znamy</div>
                    <div class="nav-item" data-section="feeding"><span class="icon">üåæ</span>K≈ïmenie</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">≈†port</div>
                    <div class="nav-item" data-section="competitions"><span class="icon">üèÜ</span>Preteky</div>
                    <div class="nav-item" data-section="licenses"><span class="icon">üìã</span>Licencie SJF/FEI</div>
                    <div class="nav-item" data-section="sjf-register"><span class="icon">üèõÔ∏è</span>SJF Register</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Financie</div>
                    <div class="nav-item" data-section="payments"><span class="icon">üí≥</span>Platby</div>
                    <div class="nav-item" data-section="memberships"><span class="icon">üé´</span>ƒålenstv√°</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Web</div>
                    <div class="nav-item" data-section="bookings"><span class="icon">üìù</span>Rezerv√°cie</div>
                    <div class="nav-item" data-section="messages"><span class="icon">‚úâÔ∏è</span>Spr√°vy</div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Obsah webu</div>
                    <div class="nav-item" data-section="articles"><span class="icon">üì∞</span>ƒål√°nky</div>
                    <div class="nav-item" data-section="gallery"><span class="icon">üñºÔ∏è</span>Gal√©ria</div>
                    <div class="nav-item" data-section="pages"><span class="icon">üìÑ</span>Str√°nky</div>
                    <div class="nav-item" data-section="documents"><span class="icon">üìé</span>Dokumenty</div>
                    <div class="nav-item" data-section="partners"><span class="icon">ü§ù</span>Partneri</div>
                    <div class="nav-item" data-section="web-settings"><span class="icon">‚öôÔ∏è</span>Nastavenia</div>
                </div>
            </nav>
            <div style="margin-top:auto;padding-top:2rem;border-top:1px solid rgba(255,255,255,0.1)">
                <div class="nav-item" onclick="window.open('/','_blank')"><span class="icon">üåê</span>Zobrazi≈• web</div>
                <div class="nav-item" onclick="logout()"><span class="icon">üö™</span>Odhl√°si≈•</div>
            </div>
        </aside>

        <main class="main">
            <!-- DASHBOARD -->
            <section id="dashboard" class="section active">
                <div class="header"><h1>Dashboard</h1><div class="header-actions"><span id="currentDate"></span></div></div>
                
                <div id="criticalAlerts"></div>
                
                <div class="stats-grid">
                    <div class="stat-card"><div class="icon green">üê¥</div><div class="value" id="statHorses">0</div><div class="label">Akt√≠vnych kon√≠</div></div>
                    <div class="stat-card"><div class="icon blue">üèá</div><div class="value" id="statRiders">0</div><div class="label">Jazdcov</div></div>
                    <div class="stat-card"><div class="icon orange">üìÖ</div><div class="value" id="statTrainings">0</div><div class="label">Dne≈°n√Ωch tr√©ningov</div></div>
                    <div class="stat-card"><div class="icon red">‚ö†Ô∏è</div><div class="value" id="statAlerts">0</div><div class="label">Upozornen√≠</div></div>
                </div>

                <div class="quick-actions">
                    <div class="quick-action" onclick="showSection('trainings');openModal('trainingModal')"><div class="icon">‚ûï</div><span>Nov√Ω tr√©ning</span></div>
                    <div class="quick-action" onclick="showSection('vet');openModal('vetModal')"><div class="icon">üíâ</div><span>Veterin√°rny z√°znam</span></div>
                    <div class="quick-action" onclick="showSection('horses');openModal('horseModal')"><div class="icon">üê¥</div><span>Prida≈• ko≈àa</span></div>
                    <div class="quick-action" onclick="showSection('riders');openModal('riderModal')"><div class="icon">üë§</div><span>Prida≈• jazdca</span></div>
                </div>

                <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem">
                    <div class="card">
                        <div class="card-header"><h3>üìÖ Dne≈°n√© tr√©ningy</h3></div>
                        <div class="card-body"><div id="todayTrainings"><p style="color:var(--gray)">Naƒç√≠tavam...</p></div></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><h3>üîî Bl√≠≈æiace sa term√≠ny</h3></div>
                        <div class="card-body"><div id="upcomingDeadlines"><p style="color:var(--gray)">Naƒç√≠tavam...</p></div></div>
                    </div>
                </div>
            </section>

            <!-- HORSES -->
            <section id="horses" class="section">
                <div class="header"><h1>üê¥ Evidencia kon√≠</h1><div class="header-actions"><div class="search-box"><input type="text" class="form-control" placeholder="Hƒæada≈•..." id="searchHorses"></div><button class="btn btn-primary" onclick="openModal('horseModal')">+ Prida≈• ko≈àa</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>Meno</th><th>Plemeno</th><th>Pas/UELN</th><th>ƒåip</th><th>SJF/FEI</th><th>Oƒçkovanie</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="horsesTable"></tbody></table></div></div>
            </section>

            <!-- RIDERS -->
            <section id="riders" class="section">
                <div class="header"><h1>üèá Evidencia jazdcov</h1><div class="header-actions"><button class="btn btn-primary" onclick="openModal('riderModal')">+ Prida≈• jazdca</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>Meno</th><th>Kateg√≥ria</th><th>SJF licencia</th><th>FEI ID</th><th>√örove≈à</th><th>Lek. potvrdenie</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="ridersTable"></tbody></table></div></div>
            </section>

            <!-- TRAINERS -->
            <section id="trainers" class="section">
                <div class="header"><h1>üë®‚Äçüè´ Tr√©neri</h1><div class="header-actions"><button class="btn btn-primary" onclick="openModal('trainerModal')">+ Prida≈• tr√©nera</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>Meno</th><th>SJF stupe≈à</th><th>≈†pecializ√°cia</th><th>Typ √∫v√§zku</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="trainersTable"></tbody></table></div></div>
            </section>

            <!-- EMPLOYEES -->
            <section id="employees" class="section">
                <div class="header"><h1>üë∑ Zamestnanci</h1><div class="header-actions"><button class="btn btn-primary" onclick="openModal('employeeModal')">+ Prida≈•</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>Meno</th><th>Poz√≠cia</th><th>Telef√≥n</th><th>Typ</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="employeesTable"></tbody></table></div></div>
            </section>

            <!-- TRAININGS -->
            <section id="trainings" class="section">
                <div class="header"><h1>üìÖ Tr√©ningy</h1><div class="header-actions"><input type="date" class="form-control" id="trainingDateFilter" style="width:auto"><button class="btn btn-primary" onclick="openModal('trainingModal')">+ Nov√Ω tr√©ning</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>D√°tum/ƒåas</th><th>Jazdec</th><th>K√¥≈à</th><th>Tr√©ner</th><th>Typ</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="trainingsTable"></tbody></table></div></div>
            </section>

            <!-- VET RECORDS -->
            <section id="vet" class="section">
                <div class="header"><h1>üè• Veterin√°rne z√°znamy</h1><div class="header-actions"><select class="form-control" id="vetHorseFilter" style="width:200px"><option value="">V≈°etky kone</option></select><button class="btn btn-primary" onclick="openModal('vetModal')">+ Nov√Ω z√°znam</button></div></div>
                
                <div class="stats-grid" style="margin-bottom:1.5rem">
                    <div class="stat-card" style="border-left:4px solid var(--danger)"><div class="value" id="vetOverdue">0</div><div class="label">Po term√≠ne</div></div>
                    <div class="stat-card" style="border-left:4px solid var(--warning)"><div class="value" id="vetSoon">0</div><div class="label">Do 30 dn√≠</div></div>
                    <div class="stat-card" style="border-left:4px solid var(--success)"><div class="value" id="vetOk">0</div><div class="label">V poriadku</div></div>
                </div>

                <div class="card"><div class="card-header"><h3>Veterin√°rne z√°znamy</h3></div><div class="card-body"><table class="table"><thead><tr><th>K√¥≈à</th><th>Typ</th><th>D√°tum</th><th>ƒéal≈°√≠ term√≠n</th><th>Veterin√°r</th><th>Pozn√°mka</th><th>Akcie</th></tr></thead><tbody id="vetTable"></tbody></table></div></div>
            </section>

            <!-- FEEDING -->
            <section id="feeding" class="section">
                <div class="header"><h1>üåæ K≈ïmenie</h1><div class="header-actions"><input type="date" class="form-control" id="feedingDate" style="width:auto"><button class="btn btn-primary" onclick="openModal('feedingModal')">+ Prida≈• z√°znam</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>K√¥≈à</th><th>D√°tum</th><th>ƒåas</th><th>K≈ïmil</th><th>Pozn√°mka</th><th>Akcie</th></tr></thead><tbody id="feedingTable"></tbody></table></div></div>
            </section>

            <!-- COMPETITIONS -->
            <section id="competitions" class="section">
                <div class="header"><h1>üèÜ Preteky a s√∫≈•a≈æe</h1><div class="header-actions"><button class="btn btn-primary" onclick="openModal('competitionModal')">+ Prida≈• preteky</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>N√°zov</th><th>D√°tum</th><th>Miesto</th><th>Discipl√≠na</th><th>Typ</th><th>Uz√°vierka</th><th>Akcie</th></tr></thead><tbody id="competitionsTable"></tbody></table></div></div>
            </section>

            <!-- LICENSES -->
            <section id="licenses" class="section">
                <div class="header"><h1>üìã Licencie SJF/FEI</h1></div>
                <div class="tabs"><div class="tab active" data-tab="licRiders">Jazdci</div><div class="tab" data-tab="licHorses">Kone</div><div class="tab" data-tab="licTrainers">Tr√©neri</div></div>
                <div class="card"><div class="card-body" id="licensesContent"><p>Vyberte kateg√≥riu</p></div></div>
            </section>

            <!-- SJF REGISTER -->
            <section id="sjf-register" class="section">
                <div class="header"><h1>üèõÔ∏è SJF Register</h1><small style="color:var(--muted)">D√°ta z evidencia.sjf.sk</small></div>
                <div class="tabs">
                    <div class="tab active" data-tab="sjfClubs">Kluby</div>
                    <div class="tab" data-tab="sjfPersons">Osoby</div>
                    <div class="tab" data-tab="sjfLegend">üìñ Vysvetlivky</div>
                </div>
                <div class="card" style="margin-bottom:1rem">
                    <div class="card-body" style="display:flex;gap:1rem;flex-wrap:wrap;align-items:center">
                        <input type="text" id="sjfSearch" placeholder="üîç Hƒæada≈• meno, klub..." style="flex:1;min-width:200px;padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius)">
                        <select id="sjfRegion" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius)">
                            <option value="">V≈°etky regi√≥ny</option>
                            <option value="B">Bratislavsk√Ω (B)</option>
                            <option value="Z">Z√°padn√© Slovensko (Z)</option>
                            <option value="S">Stredn√© Slovensko (S)</option>
                            <option value="V">V√Ωchodn√© Slovensko (V)</option>
                        </select>
                        <select id="sjfRole" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius);display:none">
                            <option value="">V≈°etky osoby</option>
                            <option value="judge">Rozhodcovia</option>
                            <option value="trainer">Tr√©neri</option>
                            <option value="builder">Stavitelia park√∫rov</option>
                            <option value="steward">Stewardi</option>
                        </select>
                        <select id="sjfStatus" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius)">
                            <option value="">V≈°etky statusy</option>
                            <option value="Akt√≠vny">Akt√≠vny</option>
                            <option value="Neakt√≠vny">Neakt√≠vny</option>
                        </select>
                    </div>
                </div>
                <div class="card"><div class="card-body" id="sjfContent"><p>Naƒç√≠tavam...</p></div></div>
            </section>

            <!-- PAYMENTS -->
            <section id="payments" class="section">
                <div class="header"><h1>üí≥ Platby</h1><div class="header-actions"><button class="btn btn-primary" onclick="openModal('paymentModal')">+ Nov√° platba</button></div></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>D√°tum</th><th>Jazdec</th><th>Typ</th><th>Popis</th><th>Suma</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="paymentsTable"></tbody></table></div></div>
            </section>

            <!-- MEMBERSHIPS -->
            <section id="memberships" class="section">
                <div class="header"><h1>üé´ ƒålenstv√°</h1></div>
                <div class="card"><div class="card-body"><p style="color:var(--gray)">Modul ƒçlenstv√° - v pr√≠prave</p></div></div>
            </section>

            <!-- NOTIFICATIONS -->
            <section id="notifications" class="section">
                <div class="header"><h1>üîî Upozornenia</h1></div>
                <div class="card"><div class="card-body notifications-list" id="notificationsList"></div></div>
            </section>

            <!-- BOOKINGS -->
            <section id="bookings" class="section">
                <div class="header"><h1>üìù Rezerv√°cie z webu</h1></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>D√°tum</th><th>Meno</th><th>Slu≈æba</th><th>Preferovan√Ω term√≠n</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="bookingsTable"></tbody></table></div></div>
            </section>

            <!-- MESSAGES -->
            <section id="messages" class="section">
                <div class="header"><h1>‚úâÔ∏è Spr√°vy z webu</h1></div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>D√°tum</th><th>Meno</th><th>Email</th><th>Spr√°va</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="messagesTable"></tbody></table></div></div>
            </section>

            <!-- ƒåL√ÅNKY -->
            <section id="articles" class="section">
                <div class="header">
                    <h1>üì∞ ƒål√°nky a novinky</h1>
                    <div class="header-actions">
                        <select id="articleCategoryFilter" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius);margin-right:0.5rem">
                            <option value="">V≈°etky kateg√≥rie</option>
                        </select>
                        <select id="articleStatusFilter" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius);margin-right:0.5rem">
                            <option value="">V≈°etky</option>
                            <option value="published">Publikovan√©</option>
                            <option value="draft">Koncepty</option>
                        </select>
                        <button class="btn btn-primary" onclick="openArticleModal()">+ Nov√Ω ƒçl√°nok</button>
                    </div>
                </div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>N√°zov</th><th>Kateg√≥ria</th><th>Autor</th><th>Status</th><th>D√°tum</th><th>Zobrazenia</th><th>Akcie</th></tr></thead><tbody id="articlesTable"></tbody></table></div></div>
            </section>

            <!-- GAL√âRIA -->
            <section id="gallery" class="section">
                <div class="header">
                    <h1>üñºÔ∏è Gal√©ria</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="openAlbumModal()">+ Nov√Ω album</button>
                    </div>
                </div>
                <div id="albumsGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem"></div>
            </section>

            <!-- STR√ÅNKY -->
            <section id="pages" class="section">
                <div class="header">
                    <h1>üìÑ Str√°nky</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openPageModal()">+ Nov√° str√°nka</button>
                    </div>
                </div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>N√°zov</th><th>URL</th><th>≈†abl√≥na</th><th>V menu</th><th>Status</th><th>Akcie</th></tr></thead><tbody id="pagesTable"></tbody></table></div></div>
            </section>

            <!-- DOKUMENTY -->
            <section id="documents" class="section">
                <div class="header">
                    <h1>üìé Dokumenty</h1>
                    <div class="header-actions">
                        <select id="docCategoryFilter" style="padding:0.5rem;border:1px solid var(--border);border-radius:var(--radius);margin-right:0.5rem">
                            <option value="">V≈°etky kateg√≥rie</option>
                            <option value="prihl√°≈°ky">Prihl√°≈°ky</option>
                            <option value="pravidl√°">Pravidl√°</option>
                            <option value="v√Ωsledky">V√Ωsledky</option>
                            <option value="in√©">In√©</option>
                        </select>
                        <button class="btn btn-primary" onclick="openDocumentModal()">+ Nov√Ω dokument</button>
                    </div>
                </div>
                <div class="card"><div class="card-body"><table class="table"><thead><tr><th>N√°zov</th><th>Kateg√≥ria</th><th>S√∫bor</th><th>Veƒækos≈•</th><th>Stiahnutia</th><th>Akcie</th></tr></thead><tbody id="documentsTable"></tbody></table></div></div>
            </section>

            <!-- PARTNERI -->
            <section id="partners" class="section">
                <div class="header">
                    <h1>ü§ù Partneri a sponzori</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openPartnerModal()">+ Nov√Ω partner</button>
                    </div>
                </div>
                <div id="partnersGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1rem"></div>
            </section>

            <!-- WEB NASTAVENIA -->
            <section id="web-settings" class="section">
                <div class="header"><h1>‚öôÔ∏è Nastavenia webu</h1></div>
                <div class="tabs" style="margin-bottom:1rem">
                    <div class="tab active" data-settings-tab="general">V≈°eobecn√©</div>
                    <div class="tab" data-settings-tab="contact">Kontakt</div>
                    <div class="tab" data-settings-tab="social">Soci√°lne siete</div>
                </div>
                <div class="card">
                    <div class="card-body" id="settingsContent">
                        <div id="settingsGeneral" class="settings-tab-content active">
                            <div class="form-group"><label>N√°zov klubu</label><input type="text" class="form-control" id="setting_site_name"></div>
                            <div class="form-group"><label>Popis</label><textarea class="form-control" id="setting_site_description" rows="3"></textarea></div>
                        </div>
                        <div id="settingsContact" class="settings-tab-content" style="display:none">
                            <div class="form-group"><label>Email</label><input type="email" class="form-control" id="setting_contact_email"></div>
                            <div class="form-group"><label>Telef√≥n</label><input type="text" class="form-control" id="setting_contact_phone"></div>
                            <div class="form-group"><label>Adresa</label><textarea class="form-control" id="setting_contact_address" rows="2"></textarea></div>
                            <div class="form-group"><label>Google Maps Embed</label><textarea class="form-control" id="setting_google_maps_embed" rows="3" placeholder="<iframe src=..."></textarea></div>
                        </div>
                        <div id="settingsSocial" class="settings-tab-content" style="display:none">
                            <div class="form-group"><label>Facebook URL</label><input type="url" class="form-control" id="setting_social_facebook"></div>
                            <div class="form-group"><label>Instagram URL</label><input type="url" class="form-control" id="setting_social_instagram"></div>
                            <div class="form-group"><label>YouTube URL</label><input type="url" class="form-control" id="setting_social_youtube"></div>
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings()" style="margin-top:1rem">Ulo≈æi≈• nastavenia</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODALS -->
    
    <!-- Article Modal -->
    <div class="modal" id="articleModal">
        <div class="modal-content" style="max-width:900px">
            <div class="modal-header"><h3 id="articleModalTitle">Nov√Ω ƒçl√°nok</h3><button class="modal-close" onclick="closeModal('articleModal')">√ó</button></div>
            <div class="modal-body">
                <form id="articleForm">
                    <input type="hidden" id="articleId">
                    <div class="form-row">
                        <div class="form-group" style="flex:2"><label>N√°zov *</label><input type="text" class="form-control" id="articleTitle" required></div>
                        <div class="form-group"><label>Kateg√≥ria</label>
                            <select class="form-control" id="articleCategory"></select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Autor</label><input type="text" class="form-control" id="articleAuthor"></div>
                        <div class="form-group"><label>Status</label>
                            <select class="form-control" id="articleStatus">
                                <option value="draft">Koncept</option>
                                <option value="published">Publikovan√Ω</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>Kr√°tky popis</label><textarea class="form-control" id="articleExcerpt" rows="2"></textarea></div>
                    <div class="form-group"><label>Obsah</label><textarea class="form-control" id="articleContent" rows="10" style="font-family:monospace"></textarea></div>
                    <div class="form-group">
                        <label>Tituln√Ω obr√°zok</label>
                        <div style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap">
                            <input type="file" id="articleImageFile" accept="image/*" style="flex:1" onchange="uploadArticleImage(this)">
                            <span style="color:var(--muted)">alebo</span>
                            <input type="url" class="form-control" id="articleCoverImage" placeholder="URL: https://..." style="flex:2">
                        </div>
                        <div id="articleImagePreview" style="margin-top:0.5rem"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label><input type="checkbox" id="articleFeatured"> Odpor√∫ƒçan√Ω</label></div>
                        <div class="form-group"><label><input type="checkbox" id="articlePinned"> Pripnut√Ω</label></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('articleModal')">Zru≈°i≈•</button>
                <button class="btn btn-primary" onclick="saveArticle()">Ulo≈æi≈•</button>
            </div>
        </div>
    </div>

    <!-- Page Modal -->
    <div class="modal" id="pageModal">
        <div class="modal-content" style="max-width:900px">
            <div class="modal-header"><h3 id="pageModalTitle">Nov√° str√°nka</h3><button class="modal-close" onclick="closeModal('pageModal')">√ó</button></div>
            <div class="modal-body">
                <form id="pageForm">
                    <input type="hidden" id="pageId">
                    <div class="form-row">
                        <div class="form-group" style="flex:2"><label>N√°zov *</label><input type="text" class="form-control" id="pageTitle" required></div>
                        <div class="form-group"><label>URL slug *</label><input type="text" class="form-control" id="pageSlug" required placeholder="moja-stranka"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>≈†abl√≥na</label>
                            <select class="form-control" id="pageTemplate">
                                <option value="default">≈†tandardn√°</option>
                                <option value="contact">Kontakt</option>
                                <option value="about">O n√°s</option>
                                <option value="services">Slu≈æby</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Poradie v menu</label><input type="number" class="form-control" id="pageMenuOrder" value="0"></div>
                    </div>
                    <div class="form-group"><label>Obsah str√°nky</label><textarea class="form-control" id="pageContent" rows="12" style="font-family:monospace"></textarea></div>
                    <div class="form-row">
                        <div class="form-group"><label><input type="checkbox" id="pagePublished"> Publikovan√°</label></div>
                        <div class="form-group"><label><input type="checkbox" id="pageInMenu"> Zobrazi≈• v menu</label></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('pageModal')">Zru≈°i≈•</button>
                <button class="btn btn-primary" onclick="savePage()">Ulo≈æi≈•</button>
            </div>
        </div>
    </div>

    <!-- Partner Modal -->
    <div class="modal" id="partnerModal">
        <div class="modal-content" style="max-width:600px">
            <div class="modal-header"><h3 id="partnerModalTitle">Nov√Ω partner</h3><button class="modal-close" onclick="closeModal('partnerModal')">√ó</button></div>
            <div class="modal-body">
                <form id="partnerForm">
                    <input type="hidden" id="partnerId">
                    <div class="form-group"><label>N√°zov *</label><input type="text" class="form-control" id="partnerName" required></div>
                    <div class="form-group"><label>Typ</label>
                        <select class="form-control" id="partnerType">
                            <option value="partner">Partner</option>
                            <option value="sponzor">Sponzor</option>
                            <option value="hlavny_sponzor">Hlavn√Ω sponzor</option>
                            <option value="medialny_partner">Medi√°lny partner</option>
                        </select>
                    </div>
                    <div class="form-group"><label>Web str√°nka</label><input type="url" class="form-control" id="partnerWebsite" placeholder="https://www.example.com"></div>
                    <div class="form-group">
                        <label>Logo partnera</label>
                        <div style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap">
                            <input type="file" id="partnerLogoFile" accept="image/*" style="flex:1" onchange="uploadPartnerLogo(this)">
                            <span style="color:var(--muted)">alebo</span>
                            <input type="url" class="form-control" id="partnerLogo" placeholder="URL: https://..." style="flex:2">
                        </div>
                        <div id="partnerLogoPreview" style="margin-top:0.5rem"></div>
                    </div>
                    <div class="form-group"><label>Poradie</label><input type="number" class="form-control" id="partnerOrder" value="0"></div>
                    <div class="form-group"><label><input type="checkbox" id="partnerActive" checked> Akt√≠vny</label></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('partnerModal')">Zru≈°i≈•</button>
                <button class="btn btn-primary" onclick="savePartner()">Ulo≈æi≈•</button>
            </div>
        </div>
    </div>

    <!-- Document Modal -->
    <div class="modal" id="documentModal">
        <div class="modal-content" style="max-width:600px">
            <div class="modal-header"><h3>Nov√Ω dokument</h3><button class="modal-close" onclick="closeModal('documentModal')">√ó</button></div>
            <div class="modal-body">
                <form id="documentForm">
                    <div class="form-group"><label>N√°zov *</label><input type="text" class="form-control" id="docTitle" required></div>
                    <div class="form-group"><label>Kateg√≥ria</label>
                        <select class="form-control" id="docCategory">
                            <option value="prihl√°≈°ky">Prihl√°≈°ky</option>
                            <option value="pravidl√°">Pravidl√°</option>
                            <option value="v√Ωsledky">V√Ωsledky</option>
                            <option value="in√©">In√©</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>S√∫bor *</label>
                        <div style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap">
                            <input type="file" id="docFile" accept=".pdf,.doc,.docx,.xls,.xlsx,.txt" style="flex:1" onchange="uploadDocument(this)">
                            <span style="color:var(--muted)">alebo</span>
                            <input type="url" class="form-control" id="docFileUrl" placeholder="URL: https://..." style="flex:2">
                        </div>
                        <div id="docUploadStatus" style="margin-top:0.5rem;font-size:0.85rem"></div>
                    </div>
                    <div class="form-group"><label>N√°zov s√∫boru</label><input type="text" class="form-control" id="docFileName" placeholder="dokument.pdf"></div>
                    <div class="form-group"><label>Popis</label><textarea class="form-control" id="docDescription" rows="2"></textarea></div>
                    <div class="form-group"><label><input type="checkbox" id="docPublic" checked> Verejn√Ω</label></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('documentModal')">Zru≈°i≈•</button>
                <button class="btn btn-primary" onclick="saveDocument()">Ulo≈æi≈•</button>
            </div>
        </div>
    </div>

    <!-- Album Modal -->
    <div class="modal" id="albumModal">
        <div class="modal-content" style="max-width:600px">
            <div class="modal-header"><h3 id="albumModalTitle">Nov√Ω album</h3><button class="modal-close" onclick="closeModal('albumModal')">√ó</button></div>
            <div class="modal-body">
                <form id="albumForm">
                    <input type="hidden" id="albumId">
                    <div class="form-group"><label>N√°zov *</label><input type="text" class="form-control" id="albumTitle" required></div>
                    <div class="form-group"><label>Popis</label><textarea class="form-control" id="albumDescription" rows="3"></textarea></div>
                    <div class="form-group">
                        <label>Tituln√Ω obr√°zok</label>
                        <div style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap">
                            <input type="file" id="albumCoverFile" accept="image/*" style="flex:1" onchange="uploadAlbumCover(this)">
                            <span style="color:var(--muted)">alebo</span>
                            <input type="url" class="form-control" id="albumCover" placeholder="URL: https://..." style="flex:2">
                        </div>
                        <div id="albumCoverPreview" style="margin-top:0.5rem"></div>
                    </div>
                    <div class="form-group"><label><input type="checkbox" id="albumPublic" checked> Verejn√Ω</label></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('albumModal')">Zru≈°i≈•</button>
                <button class="btn btn-primary" onclick="saveAlbum()">Ulo≈æi≈•</button>
            </div>
        </div>
    </div>

    <!-- Horse Modal -->
    <div class="modal" id="horseModal">
        <div class="modal-content" style="max-width:800px">
            <div class="modal-header"><h3 id="horseModalTitle">Prida≈• ko≈àa</h3><button class="modal-close" onclick="closeModal('horseModal')">√ó</button></div>
            <div class="modal-body">
                <form id="horseForm">
                    <input type="hidden" id="horseId">
                    <div class="tabs" style="margin-bottom:1rem"><div class="tab active" data-modal-tab="horseBasic">Z√°kladn√©</div><div class="tab" data-modal-tab="horseIdent">Identifik√°cia</div><div class="tab" data-modal-tab="horseSport">≈†port</div></div>
                    
                    <div id="horseBasic" class="modal-tab-content active">
                        <div class="form-row">
                            <div class="form-group"><label>Meno *</label><input type="text" class="form-control" id="horseName" required></div>
                            <div class="form-group"><label>Prez√Ωvka</label><input type="text" class="form-control" id="horseStableName"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Plemeno</label><input type="text" class="form-control" id="horseBreed"></div>
                            <div class="form-group"><label>Farba</label><input type="text" class="form-control" id="horseColor"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Pohlavie</label><select class="form-control" id="horseSex"><option value="gelding">Valach</option><option value="mare">Kobyla</option><option value="stallion">≈Ωrebec</option></select></div>
                            <div class="form-group"><label>D√°tum narodenia</label><input type="date" class="form-control" id="horseBirth"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>V√Ω≈°ka (cm)</label><input type="number" class="form-control" id="horseHeight"></div>
                            <div class="form-group"><label>V√°ha (kg)</label><input type="number" class="form-control" id="horseWeight"></div>
                        </div>
                        <div class="form-group"><label>Majiteƒæ</label><input type="text" class="form-control" id="horseOwner"></div>
                    </div>

                    <div id="horseIdent" class="modal-tab-content" style="display:none">
                        <fieldset class="fieldset"><legend>≈†VPS - Povinn√© √∫daje</legend>
                            <div class="form-row">
                                <div class="form-group"><label>ƒå√≠slo pasu ko≈àa *</label><input type="text" class="form-control" id="horsePassport" placeholder="SVK-2020-12345"></div>
                                <div class="form-group"><label>≈Ωivotn√© ƒç√≠slo (UELN)</label><input type="text" class="form-control" id="horseLifeNumber" placeholder="703099000012345"></div>
                            </div>
                            <div class="form-group"><label>Mikroƒçip <small>(ISO 11784, povinn√Ω od 2013)</small></label><input type="text" class="form-control" id="horseMicrochip" placeholder="941000012345678"></div>
                        </fieldset>
                        <fieldset class="fieldset"><legend>FEI registr√°cia</legend>
                            <div class="form-row">
                                <div class="form-group"><label>FEI ID</label><input type="text" class="form-control" id="horseFeiId" placeholder="SVK40123"></div>
                                <div class="form-group"><label>FEI pas - platnos≈•</label><input type="date" class="form-control" id="horseFeiExpiry"></div>
                            </div>
                        </fieldset>
                        <fieldset class="fieldset"><legend>SJF registr√°cia</legend>
                            <div class="form-row">
                                <div class="form-group"><label>SJF licencia ko≈àa</label><input type="text" class="form-control" id="horseSjfLicense" placeholder="SK-H-2020-001"></div>
                                <div class="form-group"><label>Platnos≈• do</label><input type="date" class="form-control" id="horseSjfExpiry"></div>
                            </div>
                        </fieldset>
                    </div>

                    <div id="horseSport" class="modal-tab-content" style="display:none">
                        <div class="form-row">
                            <div class="form-group"><label>√örove≈à</label><select class="form-control" id="horseLevel"><option value="beginner">Zaƒçiatoƒçn√≠ci</option><option value="intermediate">Pokroƒçil√≠</option><option value="advanced">Sk√∫sen√≠</option><option value="children">Deti</option><option value="competition">S√∫≈•a≈æn√Ω</option></select></div>
                            <div class="form-group"><label>Status</label><select class="form-control" id="horseStatus"><option value="active">Akt√≠vny</option><option value="retired">D√¥chodca</option><option value="sold">Predan√Ω</option><option value="temporary_out">Doƒçasne mimo</option></select></div>
                        </div>
                        <div class="form-group"><label>Discipl√≠ny</label><div style="display:flex;gap:1rem;flex-wrap:wrap"><label><input type="checkbox" class="horseDiscipline" value="skoky"> Skoky</label><label><input type="checkbox" class="horseDiscipline" value="drez√∫ra"> Drez√∫ra</label><label><input type="checkbox" class="horseDiscipline" value="v≈°estrannos≈•"> V≈°estrannos≈•</label><label><input type="checkbox" class="horseDiscipline" value="vytrvalos≈•"> Vytrvalos≈•</label><label><input type="checkbox" class="horseDiscipline" value="volt√≠≈æ"> Volt√≠≈æ</label><label><input type="checkbox" class="horseDiscipline" value="z√°prahy"> Z√°prahy</label></div></div>
                        <div class="form-group"><label>Pozn√°mky</label><textarea class="form-control" id="horseNotes"></textarea></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('horseModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveHorse()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Rider Modal -->
    <div class="modal" id="riderModal">
        <div class="modal-content" style="max-width:800px">
            <div class="modal-header"><h3 id="riderModalTitle">Prida≈• jazdca</h3><button class="modal-close" onclick="closeModal('riderModal')">√ó</button></div>
            <div class="modal-body">
                <form id="riderForm">
                    <input type="hidden" id="riderId">
                    <fieldset class="fieldset"><legend>Osobn√© √∫daje</legend>
                        <div class="form-row">
                            <div class="form-group"><label>Meno *</label><input type="text" class="form-control" id="riderFirstName" required></div>
                            <div class="form-group"><label>Priezvisko *</label><input type="text" class="form-control" id="riderLastName" required></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>D√°tum narodenia</label><input type="date" class="form-control" id="riderBirth"></div>
                            <div class="form-group"><label>Pohlavie</label><select class="form-control" id="riderGender"><option value="female">≈Ωena</option><option value="male">Mu≈æ</option></select></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Email *</label><input type="email" class="form-control" id="riderEmail" required></div>
                            <div class="form-group"><label>Telef√≥n</label><input type="tel" class="form-control" id="riderPhone"></div>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset"><legend>SJF registr√°cia</legend>
                        <div class="form-row">
                            <div class="form-group"><label>ƒå√≠slo licencie SJF</label><input type="text" class="form-control" id="riderSjfLicense" placeholder="SK-R-2020-001"></div>
                            <div class="form-group"><label>Typ licencie</label><select class="form-control" id="riderSjfType"><option value="none">Bez licencie (hobby)</option><option value="szvj">SZVJ - z√°kladn√Ω v√Ωcvik</option><option value="national">N√°rodn√° licencia</option><option value="international">Medzin√°rodn√°</option></select></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Platnos≈• do</label><input type="date" class="form-control" id="riderSjfExpiry"></div>
                            <div class="form-group"><label>D√°tum SZVJ sk√∫≈°ky</label><input type="date" class="form-control" id="riderSzvjDate"></div>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset"><legend>FEI registr√°cia</legend>
                        <div class="form-row">
                            <div class="form-group"><label>FEI ID</label><input type="text" class="form-control" id="riderFeiId"></div>
                            <div class="form-group"><label>FEI platnos≈• do</label><input type="date" class="form-control" id="riderFeiExpiry"></div>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset"><legend>Kateg√≥ria a √∫rove≈à</legend>
                        <div class="form-row">
                            <div class="form-group"><label>Kateg√≥ria (SJF)</label><select class="form-control" id="riderCategory"><option value="children">Deti (do 12)</option><option value="pony">Pony jazdci</option><option value="junior">Juniori (14-18)</option><option value="young_rider">Mlad√≠ jazdci (16-21)</option><option value="senior">Seniori (21+)</option><option value="amateur">Amat√©ri</option></select></div>
                            <div class="form-group"><label>√örove≈à</label><select class="form-control" id="riderLevel"><option value="beginner">Zaƒçiatoƒçn√≠k</option><option value="intermediate">Pokroƒçil√Ω</option><option value="advanced">Sk√∫sen√Ω</option><option value="competition">S√∫≈•a≈æn√Ω</option></select></div>
                        </div>
                    </fieldset>
                    <fieldset class="fieldset"><legend>Zdravotn√° sp√¥sobilos≈•</legend>
                        <div class="form-row">
                            <div class="form-group"><label>Lek√°rske potvrdenie</label><select class="form-control" id="riderMedical"><option value="true">Platn√©</option><option value="false">Neplatn√©</option></select></div>
                            <div class="form-group"><label>Platn√© do</label><input type="date" class="form-control" id="riderMedicalExpiry"></div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('riderModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveRider()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Trainer Modal -->
    <div class="modal" id="trainerModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Prida≈• tr√©nera</h3><button class="modal-close" onclick="closeModal('trainerModal')">√ó</button></div>
            <div class="modal-body">
                <form id="trainerForm">
                    <input type="hidden" id="trainerId">
                    <div class="form-row">
                        <div class="form-group"><label>Meno *</label><input type="text" class="form-control" id="trainerFirstName" required></div>
                        <div class="form-group"><label>Priezvisko *</label><input type="text" class="form-control" id="trainerLastName" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Email</label><input type="email" class="form-control" id="trainerEmail"></div>
                        <div class="form-group"><label>Telef√≥n</label><input type="tel" class="form-control" id="trainerPhone"></div>
                    </div>
                    <fieldset class="fieldset"><legend>SJF kvalifik√°cia</legend>
                        <div class="form-row">
                            <div class="form-group"><label>ƒå√≠slo licencie</label><input type="text" class="form-control" id="trainerSjfLicense"></div>
                            <div class="form-group"><label>Kvalifikaƒçn√Ω stupe≈à (1-4)</label><select class="form-control" id="trainerLevel"><option value="1">1. stupe≈à</option><option value="2">2. stupe≈à</option><option value="3">3. stupe≈à</option><option value="4">4. stupe≈à (najvy≈°≈°√≠)</option></select></div>
                        </div>
                    </fieldset>
                    <div class="form-group"><label>≈†pecializ√°cie</label><div style="display:flex;gap:1rem;flex-wrap:wrap"><label><input type="checkbox" class="trainerSpec" value="skoky"> Skoky</label><label><input type="checkbox" class="trainerSpec" value="drez√∫ra"> Drez√∫ra</label><label><input type="checkbox" class="trainerSpec" value="volt√≠≈æ"> Volt√≠≈æ</label><label><input type="checkbox" class="trainerSpec" value="zaƒçiatoƒçn√≠ci"> Zaƒçiatoƒçn√≠ci</label></div></div>
                    <div class="form-row">
                        <div class="form-group"><label>Typ √∫v√§zku</label><select class="form-control" id="trainerEmployment"><option value="full_time">Pln√Ω √∫v√§zok</option><option value="part_time">ƒåiastoƒçn√Ω</option><option value="external">Extern√Ω</option><option value="volunteer">Dobrovoƒæn√≠k</option></select></div>
                        <div class="form-group"><label>Hodinov√° sadzba (‚Ç¨)</label><input type="number" class="form-control" id="trainerRate" step="0.01"></div>
                    </div>
                    <div class="form-group"><label>Bio / Popis</label><textarea class="form-control" id="trainerBio"></textarea></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('trainerModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveTrainer()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Employee Modal -->
    <div class="modal" id="employeeModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Prida≈• zamestnanca</h3><button class="modal-close" onclick="closeModal('employeeModal')">√ó</button></div>
            <div class="modal-body">
                <form id="employeeForm">
                    <input type="hidden" id="employeeId">
                    <div class="form-row">
                        <div class="form-group"><label>Meno *</label><input type="text" class="form-control" id="employeeFirstName" required></div>
                        <div class="form-group"><label>Priezvisko *</label><input type="text" class="form-control" id="employeeLastName" required></div>
                    </div>
                    <div class="form-group"><label>Poz√≠cia</label><input type="text" class="form-control" id="employeePosition" placeholder="Stajn√≠k, pomocn√≠k..."></div>
                    <div class="form-row">
                        <div class="form-group"><label>Email</label><input type="email" class="form-control" id="employeeEmail"></div>
                        <div class="form-group"><label>Telef√≥n</label><input type="tel" class="form-control" id="employeePhone"></div>
                    </div>
                    <div class="form-group"><label>Typ √∫v√§zku</label><select class="form-control" id="employeeType"><option value="full_time">Pln√Ω √∫v√§zok</option><option value="part_time">ƒåiastoƒçn√Ω</option></select></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('employeeModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveEmployee()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Training Modal -->
    <div class="modal" id="trainingModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Nov√Ω tr√©ning</h3><button class="modal-close" onclick="closeModal('trainingModal')">√ó</button></div>
            <div class="modal-body">
                <form id="trainingForm">
                    <input type="hidden" id="trainingId">
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum *</label><input type="date" class="form-control" id="trainingDate" required></div>
                        <div class="form-group"><label>ƒåas *</label><input type="time" class="form-control" id="trainingTime" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Jazdec *</label><select class="form-control" id="trainingRider" required></select></div>
                        <div class="form-group"><label>K√¥≈à *</label><select class="form-control" id="trainingHorse" required></select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Tr√©ner *</label><select class="form-control" id="trainingTrainer" required></select></div>
                        <div class="form-group"><label>Typ tr√©ningu</label><select class="form-control" id="trainingType"><option value="individual">Individu√°lny</option><option value="group">Skupinov√Ω</option><option value="longe">Lon≈æovanie</option><option value="jumping">Skoky</option><option value="dressage">Drez√∫ra</option><option value="cross_country">Ter√©n</option><option value="theory">Te√≥ria</option><option value="szvj_preparation">Pr√≠prava SZVJ</option><option value="competition_prep">Pr√≠prava preteky</option></select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Trvanie (min)</label><input type="number" class="form-control" id="trainingDuration" value="60"></div>
                        <div class="form-group"><label>Cena (‚Ç¨)</label><input type="number" class="form-control" id="trainingPrice" step="0.01"></div>
                    </div>
                    <div class="form-group"><label>Pozn√°mky</label><textarea class="form-control" id="trainingNotes"></textarea></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('trainingModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveTraining()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Vet Record Modal -->
    <div class="modal" id="vetModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Veterin√°rny z√°znam</h3><button class="modal-close" onclick="closeModal('vetModal')">√ó</button></div>
            <div class="modal-body">
                <form id="vetForm">
                    <input type="hidden" id="vetId">
                    <div class="form-row">
                        <div class="form-group"><label>K√¥≈à *</label><select class="form-control" id="vetHorse" required></select></div>
                        <div class="form-group"><label>Typ z√°znamu *</label><select class="form-control" id="vetType" required>
                            <optgroup label="Oƒçkovanie"><option value="vaccination_flu">Chr√≠pka (FEI: 6 mes.)</option><option value="vaccination_tetanus">Tetanus</option><option value="vaccination_ehv">EHV-1 herpesv√≠rus</option><option value="vaccination_other">In√© oƒçkovanie</option></optgroup>
                            <optgroup label="Vy≈°etrenia"><option value="iae_test">IAE test (infekƒçn√° an√©mia)</option><option value="coggins_test">Coggins test</option><option value="examination">Veterin√°rna prehliadka</option><option value="fei_check">FEI veterin√°rna kontrola</option></optgroup>
                            <optgroup label="Starostlivos≈•"><option value="deworming">Odƒçervenie</option><option value="dental">Zuby</option><option value="farrier">Podkovanie</option></optgroup>
                            <optgroup label="Zdravie"><option value="treatment">Lieƒçba</option><option value="surgery">Chirurgia</option><option value="injury">Zranenie</option></optgroup>
                        </select></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum *</label><input type="date" class="form-control" id="vetDate" required></div>
                        <div class="form-group"><label>ƒéal≈°√≠ term√≠n</label><input type="date" class="form-control" id="vetNextDate"></div>
                    </div>
                    <div class="form-group"><label>Veterin√°r</label><input type="text" class="form-control" id="vetVeterinarian" placeholder="MVDr. J√°n Kov√°ƒç"></div>
                    <div class="form-group" id="vaccineFields" style="display:none">
                        <div class="form-row">
                            <div class="form-group"><label>N√°zov vakc√≠ny</label><input type="text" class="form-control" id="vetVaccineName"></div>
                            <div class="form-group"><label>≈†ar≈æa</label><input type="text" class="form-control" id="vetVaccineBatch"></div>
                        </div>
                    </div>
                    <div class="form-group"><label>Pozn√°mky</label><textarea class="form-control" id="vetNotes"></textarea></div>
                    <div class="form-group"><label>N√°klady (‚Ç¨)</label><input type="number" class="form-control" id="vetCost" step="0.01"></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('vetModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveVetRecord()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Feeding Modal -->
    <div class="modal" id="feedingModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Z√°znam k≈ïmenia</h3><button class="modal-close" onclick="closeModal('feedingModal')">√ó</button></div>
            <div class="modal-body">
                <form id="feedingForm">
                    <input type="hidden" id="feedingId">
                    <div class="form-row">
                        <div class="form-group"><label>K√¥≈à *</label><select class="form-control" id="feedHorse" required></select></div>
                        <div class="form-group"><label>D√°tum *</label><input type="date" class="form-control" id="feedDate" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>ƒåas k≈ïmenia</label><select class="form-control" id="feedTime"><option value="morning">R√°no</option><option value="noon">Obed</option><option value="evening">Veƒçer</option></select></div>
                        <div class="form-group"><label>K≈ïmil</label><select class="form-control" id="feedBy"></select></div>
                    </div>
                    <div class="form-group"><label>Pozn√°mky</label><textarea class="form-control" id="feedNotes"></textarea></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('feedingModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="saveFeeding()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Nov√° platba</h3><button class="modal-close" onclick="closeModal('paymentModal')">√ó</button></div>
            <div class="modal-body">
                <form id="paymentForm">
                    <input type="hidden" id="paymentId">
                    <div class="form-group"><label>Jazdec *</label><select class="form-control" id="paymentRider" required></select></div>
                    <div class="form-row">
                        <div class="form-group"><label>Typ platby *</label><select class="form-control" id="paymentType" required><option value="membership">ƒålensk√©</option><option value="training">Tr√©ning</option><option value="stabling">Ustajnenie</option><option value="competition">Preteky</option><option value="sjf_license">SJF licencia</option><option value="fei_registration">FEI registr√°cia</option><option value="vet_services">Veterin√°rne slu≈æby</option><option value="other">In√©</option></select></div>
                        <div class="form-group"><label>Suma (‚Ç¨) *</label><input type="number" class="form-control" id="paymentAmount" step="0.01" required></div>
                    </div>
                    <div class="form-group"><label>Popis</label><input type="text" class="form-control" id="paymentDescription"></div>
                    <div class="form-row">
                        <div class="form-group"><label>D√°tum splatnosti</label><input type="date" class="form-control" id="paymentDue"></div>
                        <div class="form-group"><label>Status</label><select class="form-control" id="paymentStatus"><option value="pending">Neuhraden√©</option><option value="paid">Uhraden√©</option><option value="overdue">Po splatnosti</option></select></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('paymentModal')">Zru≈°i≈•</button><button class="btn btn-primary" onclick="savePayment()">Ulo≈æi≈•</button></div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
    let token = localStorage.getItem('jkzm_token');
    let horses = [], riders = [], trainers = [], employees = [], trainings = [], vetRecords = [], payments = [], bookings = [], messages = [], competitions = [];

    // Initialize
    if (token) { showApp(); loadAll(); } else { document.getElementById('loginPage').style.display = 'flex'; }

    // Login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        try {
            const res = await fetch('/api/auth-login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({email: document.getElementById('loginEmail').value, password: document.getElementById('loginPassword').value})
            });
            const data = await res.json();
            if (data.token) { token = data.token; localStorage.setItem('jkzm_token', token); showApp(); loadAll(); }
            else { showToast(data.error || 'Nespr√°vne prihlasovacie √∫daje', 'error'); }
        } catch(e) { showToast('Chyba pripojenia', 'error'); }
    });

    function showApp() {
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('app').style.display = 'flex';
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('sk-SK', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
    }

    function logout() { localStorage.removeItem('jkzm_token'); location.reload(); }

    // Navigation
    document.querySelectorAll('.nav-item[data-section]').forEach(item => {
        item.addEventListener('click', () => showSection(item.dataset.section));
    });

    function showSection(section) {
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.querySelector(`.nav-item[data-section="${section}"]`)?.classList.add('active');
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(section)?.classList.add('active');
    }

    // Modal tabs
    document.querySelectorAll('[data-modal-tab]').forEach(tab => {
        tab.addEventListener('click', () => {
            const parent = tab.closest('.modal-body');
            parent.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            parent.querySelectorAll('.modal-tab-content').forEach(c => c.style.display = 'none');
            tab.classList.add('active');
            document.getElementById(tab.dataset.modalTab).style.display = 'block';
        });
    });

    // API calls
    async function api(endpoint, method = 'GET', body = null) {
        const opts = {method, headers: {'Content-Type': 'application/json', 'Authorization': `Bearer ${token}`}};
        if (body) opts.body = JSON.stringify(body);
        const res = await fetch(`/api/${endpoint}`, opts);
        return res.json();
    }

    async function loadAll() {
        try {
            [horses, riders, trainers, employees, trainings, vetRecords, payments, bookings, messages, competitions] = await Promise.all([
                api('horses'), api('riders'), api('trainers'), api('employees'), api('trainings'), 
                api('vet-records'), api('payments'), api('bookings'), api('contact'), api('competitions')
            ]);
        } catch(e) {
            // Fallback if some endpoints don't exist
            horses = await api('horses').catch(() => []);
            riders = await api('riders').catch(() => []);
            trainers = await api('trainers').catch(() => []);
            employees = await api('employees').catch(() => []);
            trainings = await api('trainings').catch(() => []);
            vetRecords = [];
            payments = await api('payments').catch(() => []);
            bookings = await api('bookings').catch(() => []);
            messages = await api('contact').catch(() => []);
            competitions = [];
        }
        renderAll();
        loadDashboard();
        populateSelects();
    }

    function loadDashboard() {
        document.getElementById('statHorses').textContent = horses.filter(h => h.status === 'active').length;
        document.getElementById('statRiders').textContent = riders.filter(r => r.status === 'active').length;
        const today = new Date().toISOString().split('T')[0];
        const todayTrainings = trainings.filter(t => t.date === today);
        document.getElementById('statTrainings').textContent = todayTrainings.length;
        
        // Alerts - calculate overdue vaccinations, licenses etc
        let alerts = [];
        const now = new Date();
        const in30days = new Date(now.getTime() + 30*24*60*60*1000);
        
        // Check horse vaccinations (simplified - would normally check vet_records)
        horses.forEach(h => {
            if (h.sjf_license_valid_until && new Date(h.sjf_license_valid_until) < in30days) {
                alerts.push({type: 'warning', title: `SJF licencia - ${h.name}`, text: 'Bl√≠≈æi sa vypr≈°anie licencie'});
            }
        });
        
        document.getElementById('statAlerts').textContent = alerts.length;
        document.getElementById('alertBadge').textContent = alerts.length;
        
        // Critical alerts
        const criticalHtml = alerts.slice(0, 3).map(a => 
            `<div class="alert alert-${a.type}"><span>‚ö†Ô∏è</span><div><strong>${a.title}</strong> - ${a.text}</div></div>`
        ).join('');
        document.getElementById('criticalAlerts').innerHTML = criticalHtml;
        
        // Today's trainings
        document.getElementById('todayTrainings').innerHTML = todayTrainings.length ? todayTrainings.map(t => {
            const rider = riders.find(r => r.id === t.rider_id);
            const horse = horses.find(h => h.id === t.horse_id);
            return `<div style="display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--gray-light)">
                <div><strong>${t.start_time}</strong> - ${rider?.first_name || ''} ${rider?.last_name || ''} na ${horse?.name || ''}</div>
                <span class="badge badge-${t.status === 'completed' ? 'success' : 'info'}">${t.status}</span>
            </div>`;
        }).join('') : '<p style="color:var(--gray)">≈Ωiadne tr√©ningy dnes</p>';
        
        // Upcoming deadlines
        document.getElementById('upcomingDeadlines').innerHTML = alerts.length ? alerts.slice(0, 5).map(a => 
            `<div style="display:flex;gap:0.75rem;padding:0.75rem 0;border-bottom:1px solid var(--gray-light)">
                <span>‚ö†Ô∏è</span><div><strong>${a.title}</strong><br><small style="color:var(--gray)">${a.text}</small></div>
            </div>`
        ).join('') : '<p style="color:var(--gray)">≈Ωiadne bl√≠≈æiace sa term√≠ny</p>';
    }

    function populateSelects() {
        // Horse selects
        const horseOpts = '<option value="">Vyberte ko≈àa</option>' + horses.filter(h => h.status === 'active').map(h => `<option value="${h.id}">${h.name}</option>`).join('');
        document.querySelectorAll('#trainingHorse, #vetHorse, #feedHorse, #vetHorseFilter').forEach(s => s.innerHTML = horseOpts);
        
        // Rider selects
        const riderOpts = '<option value="">Vyberte jazdca</option>' + riders.filter(r => r.status === 'active').map(r => `<option value="${r.id}">${r.first_name} ${r.last_name}</option>`).join('');
        document.querySelectorAll('#trainingRider, #paymentRider').forEach(s => s.innerHTML = riderOpts);
        
        // Trainer selects
        const trainerOpts = '<option value="">Vyberte tr√©nera</option>' + trainers.filter(t => t.status === 'active').map(t => `<option value="${t.id}">${t.first_name} ${t.last_name}</option>`).join('');
        document.querySelectorAll('#trainingTrainer').forEach(s => s.innerHTML = trainerOpts);
        
        // Employee selects
        const empOpts = '<option value="">Vyberte</option>' + employees.filter(e => e.status === 'active').map(e => `<option value="${e.id}">${e.first_name} ${e.last_name}</option>`).join('');
        document.querySelectorAll('#feedBy').forEach(s => s.innerHTML = empOpts);
    }

    function renderAll() {
        renderHorses();
        renderRiders();
        renderTrainers();
        renderEmployees();
        renderTrainings();
        renderPayments();
        renderBookings();
        renderMessages();
    }

    // Render functions
    function renderHorses() {
        const levelLabels = {beginner:'Zaƒçiatoƒçn√≠ci',intermediate:'Pokroƒçil√≠',advanced:'Sk√∫sen√≠',children:'Deti',competition:'S√∫≈•a≈æn√Ω'};
        document.getElementById('horsesTable').innerHTML = horses.map(h => `
            <tr>
                <td><strong>${h.name}</strong>${h.stable_name ? `<br><small style="color:var(--gray)">${h.stable_name}</small>` : ''}</td>
                <td>${h.breed || '-'}</td>
                <td><small>${h.passport_number || '-'}<br>${h.life_number || ''}</small></td>
                <td><small>${h.microchip || '-'}</small></td>
                <td>${h.sjf_license_number ? `<span class="badge badge-success">SJF</span>` : ''}${h.fei_id ? ` <span class="badge badge-info">FEI</span>` : ''}</td>
                <td>${h.vaccination_status || '<span class="badge badge-warning">Skontrolova≈•</span>'}</td>
                <td><span class="badge badge-${h.status === 'active' ? 'success' : 'gray'}">${h.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="editHorse('${h.id}')">‚úèÔ∏è</button> <button class="btn btn-sm btn-danger" onclick="deleteHorse('${h.id}')">üóëÔ∏è</button></td>
            </tr>
        `).join('') || '<tr><td colspan="8" style="text-align:center;color:var(--gray)">≈Ωiadne kone</td></tr>';
    }

    function renderRiders() {
        const catLabels = {children:'Deti',pony:'Pony',junior:'Junior',young_rider:'Mlad√Ω jazdec',senior:'Senior',amateur:'Amat√©r'};
        const levelLabels = {beginner:'Zaƒçiatoƒçn√≠k',intermediate:'Pokroƒçil√Ω',advanced:'Sk√∫sen√Ω',competition:'S√∫≈•a≈æn√Ω'};
        const licLabels = {none:'Hobby',szvj:'SZVJ',national:'N√°rodn√°',international:'Medzin√°rodn√°'};
        document.getElementById('ridersTable').innerHTML = riders.map(r => `
            <tr>
                <td><strong>${r.first_name} ${r.last_name}</strong></td>
                <td><span class="badge badge-info">${catLabels[r.category] || r.category || '-'}</span></td>
                <td>${r.sjf_license_number || '-'}<br><small>${licLabels[r.sjf_license_type] || ''}</small></td>
                <td>${r.fei_id || '-'}</td>
                <td>${levelLabels[r.level] || '-'}</td>
                <td><span class="badge badge-${r.medical_certificate_valid ? 'success' : 'danger'}">${r.medical_certificate_valid ? 'Platn√©' : 'Neplatn√©'}</span></td>
                <td><span class="badge badge-${r.status === 'active' ? 'success' : 'gray'}">${r.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="editRider('${r.id}')">‚úèÔ∏è</button> <button class="btn btn-sm btn-danger" onclick="deleteRider('${r.id}')">üóëÔ∏è</button></td>
            </tr>
        `).join('') || '<tr><td colspan="8" style="text-align:center;color:var(--gray)">≈Ωiadni jazdci</td></tr>';
    }

    function renderTrainers() {
        document.getElementById('trainersTable').innerHTML = trainers.map(t => `
            <tr>
                <td><strong>${t.first_name} ${t.last_name}</strong></td>
                <td>${t.sjf_trainer_level ? `${t.sjf_trainer_level}. stupe≈à` : '-'}</td>
                <td>${(t.specializations || []).join(', ') || '-'}</td>
                <td>${t.employment_type || '-'}</td>
                <td><span class="badge badge-${t.status === 'active' ? 'success' : 'gray'}">${t.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="editTrainer('${t.id}')">‚úèÔ∏è</button> <button class="btn btn-sm btn-danger" onclick="deleteTrainer('${t.id}')">üóëÔ∏è</button></td>
            </tr>
        `).join('') || '<tr><td colspan="6" style="text-align:center;color:var(--gray)">≈Ωiadni tr√©neri</td></tr>';
    }

    function renderEmployees() {
        document.getElementById('employeesTable').innerHTML = employees.map(e => `
            <tr>
                <td><strong>${e.first_name} ${e.last_name}</strong></td>
                <td>${e.position || '-'}</td>
                <td>${e.phone || '-'}</td>
                <td>${e.employment_type || '-'}</td>
                <td><span class="badge badge-${e.status === 'active' ? 'success' : 'gray'}">${e.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="editEmployee('${e.id}')">‚úèÔ∏è</button> <button class="btn btn-sm btn-danger" onclick="deleteEmployee('${e.id}')">üóëÔ∏è</button></td>
            </tr>
        `).join('') || '<tr><td colspan="6" style="text-align:center;color:var(--gray)">≈Ωiadni zamestnanci</td></tr>';
    }

    function renderTrainings() {
        const typeLabels = {individual:'Individu√°lny',group:'Skupinov√Ω',longe:'Lon≈æovanie',jumping:'Skoky',dressage:'Drez√∫ra',cross_country:'Ter√©n',theory:'Te√≥ria',szvj_preparation:'SZVJ pr√≠prava',competition_prep:'Pr√≠prava preteky'};
        document.getElementById('trainingsTable').innerHTML = trainings.map(t => {
            const rider = riders.find(r => r.id === t.rider_id);
            const horse = horses.find(h => h.id === t.horse_id);
            const trainer = trainers.find(tr => tr.id === t.trainer_id);
            return `<tr>
                <td><strong>${t.date}</strong><br><small>${t.start_time}</small></td>
                <td>${rider ? `${rider.first_name} ${rider.last_name}` : '-'}</td>
                <td>${horse?.name || '-'}</td>
                <td>${trainer ? `${trainer.first_name} ${trainer.last_name}` : '-'}</td>
                <td>${typeLabels[t.training_type] || t.training_type || '-'}</td>
                <td><span class="badge badge-${t.status === 'completed' ? 'success' : t.status === 'cancelled' ? 'danger' : 'info'}">${t.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="editTraining('${t.id}')">‚úèÔ∏è</button> <button class="btn btn-sm btn-danger" onclick="deleteTraining('${t.id}')">üóëÔ∏è</button></td>
            </tr>`;
        }).join('') || '<tr><td colspan="7" style="text-align:center;color:var(--gray)">≈Ωiadne tr√©ningy</td></tr>';
    }

    function renderPayments() {
        const typeLabels = {membership:'ƒålensk√©',training:'Tr√©ning',stabling:'Ustajnenie',competition:'Preteky',sjf_license:'SJF licencia',fei_registration:'FEI',vet_services:'Veterin√°r',other:'In√©'};
        document.getElementById('paymentsTable').innerHTML = payments.map(p => {
            const rider = riders.find(r => r.id === p.rider_id);
            return `<tr>
                <td>${p.payment_date || p.created_at?.split('T')[0] || '-'}</td>
                <td>${rider ? `${rider.first_name} ${rider.last_name}` : '-'}</td>
                <td>${typeLabels[p.payment_type] || p.payment_type || '-'}</td>
                <td>${p.description || '-'}</td>
                <td><strong>${p.amount} ‚Ç¨</strong></td>
                <td><span class="badge badge-${p.status === 'paid' ? 'success' : p.status === 'overdue' ? 'danger' : 'warning'}">${p.status}</span></td>
                <td><button class="btn btn-sm btn-danger" onclick="deletePayment('${p.id}')">üóëÔ∏è</button></td>
            </tr>`;
        }).join('') || '<tr><td colspan="7" style="text-align:center;color:var(--gray)">≈Ωiadne platby</td></tr>';
    }

    function renderBookings() {
        document.getElementById('bookingsTable').innerHTML = bookings.map(b => `
            <tr>
                <td>${b.created_at?.split('T')[0] || '-'}</td>
                <td><strong>${b.name}</strong><br><small>${b.email}</small></td>
                <td>${b.service || '-'}</td>
                <td>${b.preferred_date || '-'} ${b.preferred_time || ''}</td>
                <td><span class="badge badge-${b.status === 'confirmed' ? 'success' : 'warning'}">${b.status}</span></td>
                <td><button class="btn btn-sm btn-primary" onclick="confirmBooking('${b.id}')">‚úì</button></td>
            </tr>
        `).join('') || '<tr><td colspan="6" style="text-align:center;color:var(--gray)">≈Ωiadne rezerv√°cie</td></tr>';
    }

    function renderMessages() {
        document.getElementById('messagesTable').innerHTML = messages.map(m => `
            <tr>
                <td>${m.created_at?.split('T')[0] || '-'}</td>
                <td><strong>${m.name}</strong></td>
                <td>${m.email}</td>
                <td style="max-width:300px;overflow:hidden;text-overflow:ellipsis">${m.message}</td>
                <td><span class="badge badge-${m.status === 'read' ? 'gray' : 'warning'}">${m.status}</span></td>
                <td><button class="btn btn-sm btn-outline" onclick="markMessageRead('${m.id}')">üìñ</button></td>
            </tr>
        `).join('') || '<tr><td colspan="6" style="text-align:center;color:var(--gray)">≈Ωiadne spr√°vy</td></tr>';
    }

    // Modal functions
    function openModal(id) { document.getElementById(id).classList.add('active'); }
    function closeModal(id) { document.getElementById(id).classList.remove('active'); }

    // CRUD - Horses
    async function saveHorse() {
        const id = document.getElementById('horseId').value;
        const data = {
            name: document.getElementById('horseName').value,
            stable_name: document.getElementById('horseStableName').value,
            breed: document.getElementById('horseBreed').value,
            color: document.getElementById('horseColor').value,
            sex: document.getElementById('horseSex').value,
            birth_date: document.getElementById('horseBirth').value || null,
            height_cm: document.getElementById('horseHeight').value || null,
            weight_kg: document.getElementById('horseWeight').value || null,
            passport_number: document.getElementById('horsePassport').value,
            life_number: document.getElementById('horseLifeNumber').value,
            microchip: document.getElementById('horseMicrochip').value,
            fei_id: document.getElementById('horseFeiId').value,
            fei_passport_expiry: document.getElementById('horseFeiExpiry').value || null,
            sjf_license_number: document.getElementById('horseSjfLicense').value,
            sjf_license_valid_until: document.getElementById('horseSjfExpiry').value || null,
            owner_name: document.getElementById('horseOwner').value,
            level: document.getElementById('horseLevel').value,
            status: document.getElementById('horseStatus').value,
            disciplines: Array.from(document.querySelectorAll('.horseDiscipline:checked')).map(c => c.value),
            notes: document.getElementById('horseNotes').value
        };
        await api(id ? `horses/${id}` : 'horses', id ? 'PUT' : 'POST', data);
        closeModal('horseModal');
        showToast('K√¥≈à ulo≈æen√Ω!', 'success');
        horses = await api('horses');
        renderHorses();
        populateSelects();
    }

    function editHorse(id) {
        const h = horses.find(x => x.id === id);
        if (!h) return;
        document.getElementById('horseId').value = h.id;
        document.getElementById('horseName').value = h.name || '';
        document.getElementById('horseStableName').value = h.stable_name || '';
        document.getElementById('horseBreed').value = h.breed || '';
        document.getElementById('horseColor').value = h.color || '';
        document.getElementById('horseSex').value = h.sex || 'gelding';
        document.getElementById('horseBirth').value = h.birth_date?.split('T')[0] || '';
        document.getElementById('horseHeight').value = h.height_cm || '';
        document.getElementById('horseWeight').value = h.weight_kg || '';
        document.getElementById('horsePassport').value = h.passport_number || '';
        document.getElementById('horseLifeNumber').value = h.life_number || '';
        document.getElementById('horseMicrochip').value = h.microchip || '';
        document.getElementById('horseFeiId').value = h.fei_id || '';
        document.getElementById('horseFeiExpiry').value = h.fei_passport_expiry?.split('T')[0] || '';
        document.getElementById('horseSjfLicense').value = h.sjf_license_number || '';
        document.getElementById('horseSjfExpiry').value = h.sjf_license_valid_until?.split('T')[0] || '';
        document.getElementById('horseOwner').value = h.owner_name || '';
        document.getElementById('horseLevel').value = h.level || 'beginner';
        document.getElementById('horseStatus').value = h.status || 'active';
        document.getElementById('horseNotes').value = h.notes || '';
        document.querySelectorAll('.horseDiscipline').forEach(c => c.checked = (h.disciplines || []).includes(c.value));
        document.getElementById('horseModalTitle').textContent = 'Upravi≈• ko≈àa';
        openModal('horseModal');
    }

    async function deleteHorse(id) {
        if (!confirm('Naozaj vymaza≈• tohto ko≈àa?')) return;
        await api(`horses/${id}`, 'DELETE');
        showToast('K√¥≈à vymazan√Ω', 'success');
        horses = await api('horses');
        renderHorses();
        populateSelects();
    }

    // CRUD - Riders
    async function saveRider() {
        const id = document.getElementById('riderId').value;
        const data = {
            first_name: document.getElementById('riderFirstName').value,
            last_name: document.getElementById('riderLastName').value,
            birth_date: document.getElementById('riderBirth').value || null,
            gender: document.getElementById('riderGender').value,
            email: document.getElementById('riderEmail').value,
            phone: document.getElementById('riderPhone').value,
            sjf_license_number: document.getElementById('riderSjfLicense').value,
            sjf_license_type: document.getElementById('riderSjfType').value,
            sjf_license_valid_until: document.getElementById('riderSjfExpiry').value || null,
            szvj_date: document.getElementById('riderSzvjDate').value || null,
            fei_id: document.getElementById('riderFeiId').value,
            fei_license_valid_until: document.getElementById('riderFeiExpiry').value || null,
            category: document.getElementById('riderCategory').value,
            level: document.getElementById('riderLevel').value,
            medical_certificate_valid: document.getElementById('riderMedical').value === 'true',
            medical_certificate_expiry: document.getElementById('riderMedicalExpiry').value || null
        };
        await api(id ? `riders/${id}` : 'riders', id ? 'PUT' : 'POST', data);
        closeModal('riderModal');
        showToast('Jazdec ulo≈æen√Ω!', 'success');
        riders = await api('riders');
        renderRiders();
        populateSelects();
    }

    function editRider(id) {
        const r = riders.find(x => x.id === id);
        if (!r) return;
        document.getElementById('riderId').value = r.id;
        document.getElementById('riderFirstName').value = r.first_name || '';
        document.getElementById('riderLastName').value = r.last_name || '';
        document.getElementById('riderBirth').value = r.birth_date?.split('T')[0] || '';
        document.getElementById('riderGender').value = r.gender || 'female';
        document.getElementById('riderEmail').value = r.email || '';
        document.getElementById('riderPhone').value = r.phone || '';
        document.getElementById('riderSjfLicense').value = r.sjf_license_number || '';
        document.getElementById('riderSjfType').value = r.sjf_license_type || 'none';
        document.getElementById('riderSjfExpiry').value = r.sjf_license_valid_until?.split('T')[0] || '';
        document.getElementById('riderSzvjDate').value = r.szvj_date?.split('T')[0] || '';
        document.getElementById('riderFeiId').value = r.fei_id || '';
        document.getElementById('riderFeiExpiry').value = r.fei_license_valid_until?.split('T')[0] || '';
        document.getElementById('riderCategory').value = r.category || 'senior';
        document.getElementById('riderLevel').value = r.level || 'beginner';
        document.getElementById('riderMedical').value = r.medical_certificate_valid ? 'true' : 'false';
        document.getElementById('riderMedicalExpiry').value = r.medical_certificate_expiry?.split('T')[0] || '';
        document.getElementById('riderModalTitle').textContent = 'Upravi≈• jazdca';
        openModal('riderModal');
    }

    async function deleteRider(id) {
        if (!confirm('Naozaj vymaza≈• tohto jazdca?')) return;
        await api(`riders/${id}`, 'DELETE');
        showToast('Jazdec vymazan√Ω', 'success');
        riders = await api('riders');
        renderRiders();
        populateSelects();
    }

    // CRUD - Trainers
    async function saveTrainer() {
        const id = document.getElementById('trainerId').value;
        const data = {
            first_name: document.getElementById('trainerFirstName').value,
            last_name: document.getElementById('trainerLastName').value,
            email: document.getElementById('trainerEmail').value,
            phone: document.getElementById('trainerPhone').value,
            sjf_license_number: document.getElementById('trainerSjfLicense').value,
            sjf_trainer_level: parseInt(document.getElementById('trainerLevel').value),
            specializations: Array.from(document.querySelectorAll('.trainerSpec:checked')).map(c => c.value),
            employment_type: document.getElementById('trainerEmployment').value,
            hourly_rate: document.getElementById('trainerRate').value || null,
            bio: document.getElementById('trainerBio').value
        };
        await api(id ? `trainers/${id}` : 'trainers', id ? 'PUT' : 'POST', data);
        closeModal('trainerModal');
        showToast('Tr√©ner ulo≈æen√Ω!', 'success');
        trainers = await api('trainers');
        renderTrainers();
        populateSelects();
    }

    function editTrainer(id) {
        const t = trainers.find(x => x.id === id);
        if (!t) return;
        document.getElementById('trainerId').value = t.id;
        document.getElementById('trainerFirstName').value = t.first_name || '';
        document.getElementById('trainerLastName').value = t.last_name || '';
        document.getElementById('trainerEmail').value = t.email || '';
        document.getElementById('trainerPhone').value = t.phone || '';
        document.getElementById('trainerSjfLicense').value = t.sjf_license_number || '';
        document.getElementById('trainerLevel').value = t.sjf_trainer_level || '1';
        document.querySelectorAll('.trainerSpec').forEach(c => c.checked = (t.specializations || []).includes(c.value));
        document.getElementById('trainerEmployment').value = t.employment_type || 'full_time';
        document.getElementById('trainerRate').value = t.hourly_rate || '';
        document.getElementById('trainerBio').value = t.bio || '';
        openModal('trainerModal');
    }

    async function deleteTrainer(id) {
        if (!confirm('Naozaj vymaza≈• tohto tr√©nera?')) return;
        await api(`trainers/${id}`, 'DELETE');
        showToast('Tr√©ner vymazan√Ω', 'success');
        trainers = await api('trainers');
        renderTrainers();
        populateSelects();
    }

    // CRUD - Employees
    async function saveEmployee() {
        const id = document.getElementById('employeeId').value;
        const data = {
            first_name: document.getElementById('employeeFirstName').value,
            last_name: document.getElementById('employeeLastName').value,
            position: document.getElementById('employeePosition').value,
            email: document.getElementById('employeeEmail').value,
            phone: document.getElementById('employeePhone').value,
            employment_type: document.getElementById('employeeType').value
        };
        await api(id ? `employees/${id}` : 'employees', id ? 'PUT' : 'POST', data);
        closeModal('employeeModal');
        showToast('Zamestnanec ulo≈æen√Ω!', 'success');
        employees = await api('employees');
        renderEmployees();
        populateSelects();
    }

    function editEmployee(id) {
        const e = employees.find(x => x.id === id);
        if (!e) return;
        document.getElementById('employeeId').value = e.id;
        document.getElementById('employeeFirstName').value = e.first_name || '';
        document.getElementById('employeeLastName').value = e.last_name || '';
        document.getElementById('employeePosition').value = e.position || '';
        document.getElementById('employeeEmail').value = e.email || '';
        document.getElementById('employeePhone').value = e.phone || '';
        document.getElementById('employeeType').value = e.employment_type || 'full_time';
        openModal('employeeModal');
    }

    async function deleteEmployee(id) {
        if (!confirm('Naozaj vymaza≈• tohto zamestnanca?')) return;
        await api(`employees/${id}`, 'DELETE');
        showToast('Zamestnanec vymazan√Ω', 'success');
        employees = await api('employees');
        renderEmployees();
        populateSelects();
    }

    // CRUD - Trainings
    async function saveTraining() {
        const id = document.getElementById('trainingId').value;
        const riderId = document.getElementById('trainingRider').value;
        const horseId = document.getElementById('trainingHorse').value;
        const trainerId = document.getElementById('trainingTrainer').value;
        const data = {
            rider_id: riderId || null,
            horse_id: horseId || null,
            trainer_id: trainerId || null,
            date: document.getElementById('trainingDate').value,
            start_time: document.getElementById('trainingTime').value,
            training_type: document.getElementById('trainingType').value,
            duration_minutes: parseInt(document.getElementById('trainingDuration').value) || 60,
            price: document.getElementById('trainingPrice').value || null,
            trainer_notes: document.getElementById('trainingNotes').value
        };
        await api(id ? `trainings/${id}` : 'trainings', id ? 'PUT' : 'POST', data);
        closeModal('trainingModal');
        showToast('Tr√©ning ulo≈æen√Ω!', 'success');
        trainings = await api('trainings');
        renderTrainings();
        loadDashboard();
    }

    function editTraining(id) {
        const t = trainings.find(x => x.id === id);
        if (!t) return;
        document.getElementById('trainingId').value = t.id;
        document.getElementById('trainingDate').value = t.date;
        document.getElementById('trainingTime').value = t.start_time;
        document.getElementById('trainingRider').value = t.rider_id;
        document.getElementById('trainingHorse').value = t.horse_id;
        document.getElementById('trainingTrainer').value = t.trainer_id;
        document.getElementById('trainingType').value = t.training_type || 'individual';
        document.getElementById('trainingDuration').value = t.duration_minutes || 60;
        document.getElementById('trainingPrice').value = t.price || '';
        document.getElementById('trainingNotes').value = t.notes || '';
        openModal('trainingModal');
    }

    async function deleteTraining(id) {
        if (!confirm('Naozaj vymaza≈• tento tr√©ning?')) return;
        await api(`trainings/${id}`, 'DELETE');
        showToast('Tr√©ning vymazan√Ω', 'success');
        trainings = await api('trainings');
        renderTrainings();
        loadDashboard();
    }

    // CRUD - Payments
    async function savePayment() {
        const riderId = document.getElementById('paymentRider').value;
        const data = {
            rider_id: riderId || null,
            payment_type: document.getElementById('paymentType').value,
            amount: parseFloat(document.getElementById('paymentAmount').value),
            description: document.getElementById('paymentDescription').value,
            payment_date: document.getElementById('paymentDue').value || null,
            status: document.getElementById('paymentStatus').value
        };
        await api('payments', 'POST', data);
        closeModal('paymentModal');
        showToast('Platba ulo≈æen√°!', 'success');
        payments = await api('payments');
        renderPayments();
    }

    async function deletePayment(id) {
        if (!confirm('Naozaj vymaza≈• t√∫to platbu?')) return;
        await api(`payments/${id}`, 'DELETE');
        showToast('Platba vymazan√°', 'success');
        payments = await api('payments');
        renderPayments();
    }

    // CRUD - Vet Records
    async function saveVetRecord() {
        const horseId = document.getElementById('vetHorse').value;
        const data = {
            horse_id: horseId || null,
            record_type: document.getElementById('vetType').value,
            record_date: document.getElementById('vetDate').value,
            next_due_date: document.getElementById('vetNextDate').value || null,
            vet_name: document.getElementById('vetVeterinarian').value,
            vaccine_name: document.getElementById('vetVaccineName').value,
            vaccine_batch: document.getElementById('vetVaccineBatch').value,
            notes: document.getElementById('vetNotes').value,
            cost: document.getElementById('vetCost').value || null
        };
        await api('vet-records', 'POST', data);
        closeModal('vetModal');
        showToast('Veterin√°rny z√°znam ulo≈æen√Ω!', 'success');
        vetRecords = await api('vet-records').catch(() => []);
    }

    // CRUD - Feeding
    async function saveFeeding() {
        const horseId = document.getElementById('feedHorse').value;
        const employeeId = document.getElementById('feedBy').value;
        const data = {
            horse_id: horseId || null,
            date: document.getElementById('feedDate').value,
            time_slot: document.getElementById('feedTime').value,
            employee_id: employeeId || null,
            notes: document.getElementById('feedNotes').value
        };
        await api('feeding', 'POST', data);
        closeModal('feedingModal');
        showToast('Z√°znam k≈ïmenia ulo≈æen√Ω!', 'success');
    }

    // Bookings
    async function confirmBooking(id) {
        await api(`bookings/${id}`, 'PUT', {status: 'confirmed'});
        showToast('Rezerv√°cia potvrden√°', 'success');
        bookings = await api('bookings');
        renderBookings();
    }

    // Messages
    async function markMessageRead(id) {
        await api(`contact/${id}`, 'PUT', {status: 'read'});
        showToast('Oznaƒçen√© ako preƒç√≠tan√©', 'success');
        messages = await api('contact');
        renderMessages();
    }

    // Vet type change - show/hide vaccine fields
    document.getElementById('vetType')?.addEventListener('change', function() {
        const isVaccine = this.value.startsWith('vaccination');
        document.getElementById('vaccineFields').style.display = isVaccine ? 'block' : 'none';
    });

    // Toast
    function showToast(msg, type = '') {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.className = 'toast show ' + type;
        setTimeout(() => t.classList.remove('show'), 3000);
    }

    // ===== SJF REGISTER =====
    let currentSjfTab = 'sjfClubs';
    
    // Tab prep√≠nanie pre SJF
    document.querySelectorAll('#sjf-register .tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('#sjf-register .tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            currentSjfTab = tab.dataset.tab;
            // Uk√°≈æ/skry filter role podƒæa tabu
            document.getElementById('sjfRole').style.display = currentSjfTab === 'sjfPersons' ? 'block' : 'none';
            loadSjfData();
        });
    });
    
    // Filtre
    document.getElementById('sjfSearch').addEventListener('input', debounce(loadSjfData, 300));
    document.getElementById('sjfRegion').addEventListener('change', loadSjfData);
    document.getElementById('sjfRole').addEventListener('change', loadSjfData);
    document.getElementById('sjfStatus').addEventListener('change', loadSjfData);
    
    function debounce(func, wait) {
        let timeout;
        return function(...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), wait);
        };
    }
    
    async function loadSjfData() {
        const search = document.getElementById('sjfSearch').value;
        const region = document.getElementById('sjfRegion').value;
        const status = document.getElementById('sjfStatus').value;
        const role = document.getElementById('sjfRole').value;
        const container = document.getElementById('sjfContent');
        
        // Vysvetlivky tab
        if (currentSjfTab === 'sjfLegend') {
            showSjfLegend();
            return;
        }
        
        container.innerHTML = '<p>Naƒç√≠tavam...</p>';
        
        try {
            if (currentSjfTab === 'sjfClubs') {
                await loadSjfClubs(search, region, status);
            } else if (currentSjfTab === 'sjfPersons') {
                await loadSjfPersons(search, region, status, role);
            }
        } catch (e) {
            container.innerHTML = '<p style="color:var(--danger)">Chyba: ' + e.message + '</p>';
        }
    }
    
    function showSjfLegend() {
        document.getElementById('sjfContent').innerHTML = `
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem">
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">üèÜ Rozhodcovia (R)</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td><code>RS</code></td><td>Skoky</td></tr>
                        <tr><td><code>RD</code></td><td>Drez√∫ra</td></tr>
                        <tr><td><code>RC</code></td><td>V≈°estrannos≈• (Cross)</td></tr>
                        <tr><td><code>RV</code></td><td>Volt√≠≈æ</td></tr>
                        <tr><td><code>RE</code></td><td>Vytrvalos≈• (Endurance)</td></tr>
                        <tr><td><code>RA</code></td><td>Are√°l</td></tr>
                        <tr><td><code>RPV</code></td><td>Para Volt√≠≈æ</td></tr>
                        <tr><td><code>F</code></td><td>FEI medzin√°rodn√Ω</td></tr>
                    </table>
                    <p style="margin-top:0.5rem;font-size:0.8rem;color:var(--muted)">ƒå√≠slo = √∫rove≈à (1-4, kde 4 je najvy≈°≈°ia)</p>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">üèóÔ∏è Stavitelia park√∫rov (S)</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td><code>SS</code></td><td>Skoky</td></tr>
                        <tr><td><code>SC</code></td><td>V≈°estrannos≈• Cross</td></tr>
                        <tr><td><code>SA</code></td><td>Are√°l</td></tr>
                        <tr><td><code>FSS</code></td><td>FEI medzin√°rodn√Ω Skoky</td></tr>
                    </table>
                    <p style="margin-top:0.5rem;font-size:0.8rem;color:var(--muted)">ƒå√≠slo = √∫rove≈à (1-4)</p>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">üë®‚Äçüè´ Tr√©neri</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td><code>Tr√©ner 1</code></td><td>Z√°kladn√° licencia</td></tr>
                        <tr><td><code>Tr√©ner 2</code></td><td>Stredn√° licencia</td></tr>
                        <tr><td><code>Tr√©ner 3</code></td><td>Najvy≈°≈°ia licencia</td></tr>
                        <tr><td><code>C</code></td><td>Coach</td></tr>
                    </table>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">üé´ Stewardi (K)</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td><code>KS</code></td><td>Skoky</td></tr>
                        <tr><td><code>KD</code></td><td>Drez√∫ra</td></tr>
                        <tr><td><code>KC</code></td><td>V≈°estrannos≈•</td></tr>
                        <tr><td><code>KE</code></td><td>Vytrvalos≈•</td></tr>
                        <tr><td><code>FKS</code></td><td>FEI Steward</td></tr>
                    </table>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">üìç Regi√≥ny</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td><code>B</code></td><td>Bratislavsk√Ω kraj</td></tr>
                        <tr><td><code>Z</code></td><td>Z√°padn√© Slovensko</td></tr>
                        <tr><td><code>S</code></td><td>Stredn√© Slovensko</td></tr>
                        <tr><td><code>V</code></td><td>V√Ωchodn√© Slovensko</td></tr>
                    </table>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;color:var(--primary)">‚ÑπÔ∏è Status</h3>
                    <table class="table" style="font-size:0.85rem">
                        <tr><td style="color:var(--success)">‚óè</td><td><strong>Akt√≠vny</strong> - platn√° licencia pre aktu√°lnu sez√≥nu</td></tr>
                        <tr><td style="color:var(--muted)">‚óè</td><td><strong>Neakt√≠vny</strong> - licencia ƒçak√° na obnovenie alebo expirovala</td></tr>
                    </table>
                    <p style="margin-top:0.5rem;font-size:0.8rem;color:var(--muted)">Licencie sa aktivuj√∫ priebe≈æne poƒças roka</p>
                </div>
            </div>
        `;
    }
    
    async function loadSjfClubs(search, region, status) {
        let url = `/api/sjf-clubs?`;
        if (search) url += `search=${encodeURIComponent(search)}&`;
        if (region) url += `region=${region}&`;
        if (status) url += `status=${status}&`;
        
        const res = await fetch(url);
        const data = await res.json();
        
        if (data.length === 0) {
            document.getElementById('sjfContent').innerHTML = '<p>≈Ωiadne kluby</p>';
            return;
        }
        
        let html = '<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1rem">';
        data.forEach(c => {
            html += `
                <div style="border:1px solid var(--border);border-radius:var(--radius);padding:1rem;background:var(--card)">
                    <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:0.5rem">
                        <strong style="font-size:1rem">${c.name}</strong>
                        ${c.is_riding_school ? '<span style="background:var(--success);color:#fff;padding:0.1rem 0.5rem;border-radius:10px;font-size:0.7rem">J≈†</span>' : ''}
                    </div>
                    <div style="font-size:0.85rem;color:var(--muted);margin-bottom:0.5rem">
                        üìç ${c.city || '-'} ${c.region ? '('+c.region+')' : ''}
                    </div>
                    <div style="font-size:0.85rem;display:flex;flex-direction:column;gap:0.25rem">
                        ${c.contact_person ? '<div>üë§ ' + c.contact_person + '</div>' : ''}
                        ${c.phone ? '<div>üìû <a href="tel:' + c.phone.replace(/[^0-9+]/g,'') + '">' + c.phone + '</a></div>' : ''}
                        ${c.email ? '<div>‚úâÔ∏è <a href="mailto:' + c.email + '">' + c.email + '</a></div>' : ''}
                    </div>
                </div>
            `;
        });
        html += '</div>';
        html += `<p style="margin-top:1rem;color:var(--muted);font-size:0.85rem">Zobrazen√Ωch: ${data.length} klubov</p>`;
        
        document.getElementById('sjfContent').innerHTML = html;
    }
    
    async function loadSjfPersons(search, region, status, role) {
        let url = `/api/sjf-persons?`;
        if (role) url += `role=${role}&`;
        if (search) url += `search=${encodeURIComponent(search)}&`;
        if (region) url += `region=${region}&`;
        if (status) url += `status=${status}&`;
        
        const res = await fetch(url);
        const data = await res.json();
        
        if (data.length === 0) {
            document.getElementById('sjfContent').innerHTML = '<p>≈Ωiadne osoby</p>';
            return;
        }
        
        // Zobraz√≠me v≈°etky licencie osoby
        let html = '<table class="table"><thead><tr><th>Meno</th><th>Klub</th><th>Regi√≥n</th><th>Licencie</th><th>Status</th></tr></thead><tbody>';
        data.forEach(p => {
            // Zozbieraj v≈°etky licencie
            let licenses = [];
            if (p.judge_license) licenses.push('<span title="Rozhodca">üèÜ ' + p.judge_license + '</span>');
            if (p.trainer_license) licenses.push('<span title="Tr√©ner">üë®‚Äçüè´ ' + p.trainer_license + '</span>');
            if (p.course_builder_license) licenses.push('<span title="Staviteƒæ park√∫rov">üèóÔ∏è ' + p.course_builder_license + '</span>');
            if (p.steward_license) licenses.push('<span title="Steward">üé´ ' + p.steward_license + '</span>');
            
            const licenseStr = licenses.length > 0 ? licenses.join('<br>') : '-';
            const statusColor = p.sjf_license_status === 'Akt√≠vny' ? 'var(--success)' : 'var(--muted)';
            html += `
                <tr>
                    <td><strong>${p.first_name} ${p.surname}</strong></td>
                    <td style="font-size:0.85rem">${p.club_name || '-'}</td>
                    <td>${p.region || '-'}</td>
                    <td style="font-size:0.85rem">${licenseStr}</td>
                    <td><span style="color:${statusColor}">${p.sjf_license_status || '-'}</span></td>
                </tr>
            `;
        });
        html += '</tbody></table>';
        html += `<p style="margin-top:1rem;color:var(--muted);font-size:0.85rem">Zobrazen√Ωch: ${data.length} os√¥b</p>`;
        
        document.getElementById('sjfContent').innerHTML = html;
    }
    
    // Naƒç√≠taj SJF d√°ta pri prepnut√≠ na sekciu
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', () => {
            if (item.dataset.section === 'sjf-register') {
                setTimeout(loadSjfData, 100);
            }
            if (item.dataset.section === 'articles') {
                setTimeout(loadArticles, 100);
            }
            if (item.dataset.section === 'gallery') {
                setTimeout(loadAlbums, 100);
            }
            if (item.dataset.section === 'pages') {
                setTimeout(loadPages, 100);
            }
            if (item.dataset.section === 'documents') {
                setTimeout(loadDocuments, 100);
            }
            if (item.dataset.section === 'partners') {
                setTimeout(loadPartners, 100);
            }
            if (item.dataset.section === 'web-settings') {
                setTimeout(loadSettings, 100);
            }
        });
    });

    // ===== CMS FUNKCIE =====
    
    // ƒåL√ÅNKY
    let articleCategories = [];
    
    async function loadArticleCategories() {
        try {
            const res = await fetch('/api/article-categories');
            articleCategories = await res.json();
            const select = document.getElementById('articleCategoryFilter');
            select.innerHTML = '<option value="">V≈°etky kateg√≥rie</option>';
            articleCategories.forEach(c => {
                select.innerHTML += `<option value="${c.id}">${c.name}</option>`;
            });
        } catch(e) { console.error(e); }
    }
    
    async function loadArticles() {
        await loadArticleCategories();
        const status = document.getElementById('articleStatusFilter').value;
        const category = document.getElementById('articleCategoryFilter').value;
        
        let url = '/api/articles?';
        if (status) url += `status=${status}&`;
        if (category) url += `category=${category}&`;
        
        try {
            const res = await fetch(url);
            const data = await res.json();
            const tbody = document.getElementById('articlesTable');
            
            if (!data.length) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--muted)">≈Ωiadne ƒçl√°nky</td></tr>';
                return;
            }
            
            tbody.innerHTML = data.map(a => {
                const statusBadge = a.status === 'published' 
                    ? '<span style="color:var(--success)">Publikovan√Ω</span>'
                    : '<span style="color:var(--warning)">Koncept</span>';
                const cat = a.article_categories ? `<span style="background:${a.article_categories.color};color:#fff;padding:0.1rem 0.5rem;border-radius:10px;font-size:0.75rem">${a.article_categories.name}</span>` : '-';
                const date = a.published_at ? new Date(a.published_at).toLocaleDateString('sk') : '-';
                return `<tr>
                    <td><strong>${a.title}</strong>${a.is_featured ? ' ‚≠ê' : ''}${a.is_pinned ? ' üìå' : ''}</td>
                    <td>${cat}</td>
                    <td>${a.author || '-'}</td>
                    <td>${statusBadge}</td>
                    <td>${date}</td>
                    <td>${a.views || 0}</td>
                    <td>
                        <button class="btn btn-small" onclick="editArticle('${a.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deleteArticle('${a.id}')">üóëÔ∏è</button>
                    </td>
                </tr>`;
            }).join('');
        } catch(e) {
            document.getElementById('articlesTable').innerHTML = '<tr><td colspan="7" style="color:var(--danger)">Chyba: ' + e.message + '</td></tr>';
        }
    }
    
    document.getElementById('articleStatusFilter').addEventListener('change', loadArticles);
    document.getElementById('articleCategoryFilter').addEventListener('change', loadArticles);
    
    // Upload ƒçl√°nkov√Ω obr√°zok
    async function uploadArticleImage(input) {
        const file = input.files[0];
        if (!file) return;
        
        if (!file.type.startsWith('image/')) {
            toast('Pros√≠m vyberte obr√°zok', 'error');
            return;
        }
        if (file.size > 5 * 1024 * 1024) {
            toast('Maxim√°lna veƒækos≈• je 5MB', 'error');
            return;
        }
        
        document.getElementById('articleImagePreview').innerHTML = '<span style="color:var(--muted)">Nahr√°vam...</span>';
        
        try {
            const base64 = await new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
            
            const res = await fetch('/api/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ file: base64, filename: file.name, folder: 'articles' })
            });
            
            const data = await res.json();
            if (data.error) throw new Error(data.error);
            
            document.getElementById('articleCoverImage').value = data.url;
            document.getElementById('articleImagePreview').innerHTML = '<img src="'+data.url+'" style="max-height:100px;border-radius:4px">';
            toast('Obr√°zok nahran√Ω!', 'success');
        } catch(e) {
            document.getElementById('articleImagePreview').innerHTML = '';
            toast('Chyba pri nahr√°van√≠: ' + e.message, 'error');
        }
    }

    async function openArticleModal(id = null) {
        // Naƒç√≠taj kateg√≥rie ak e≈°te nie s√∫
        if (!articleCategories.length) {
            await loadArticleCategories();
        }
        
        // Napl≈à kateg√≥rie do selectu
        const catSelect = document.getElementById('articleCategory');
        catSelect.innerHTML = '<option value="">-- Bez kateg√≥rie --</option>';
        articleCategories.forEach(c => {
            catSelect.innerHTML += `<option value="${c.id}">${c.name}</option>`;
        });
        
        // Reset formul√°ra
        document.getElementById('articleForm').reset();
        document.getElementById('articleId').value = '';
        document.getElementById('articleModalTitle').textContent = 'Nov√Ω ƒçl√°nok';
        document.getElementById('articleImagePreview').innerHTML = '';
        document.getElementById('articleImageFile').value = '';
        
        if (id) {
            // Edit√°cia - naƒç√≠taj d√°ta
            try {
                const res = await fetch(`/api/articles/${id}`);
                const a = await res.json();
                console.log('Loaded article:', a);
                document.getElementById('articleId').value = a.id;
                document.getElementById('articleTitle').value = a.title || '';
                document.getElementById('articleCategory').value = a.category_id || '';
                document.getElementById('articleAuthor').value = a.author || '';
                document.getElementById('articleStatus').value = a.status || 'draft';
                document.getElementById('articleExcerpt').value = a.excerpt || '';
                document.getElementById('articleContent').value = a.content || '';
                document.getElementById('articleCoverImage').value = a.cover_image || '';
                document.getElementById('articleFeatured').checked = a.is_featured || false;
                document.getElementById('articlePinned').checked = a.is_pinned || false;
                document.getElementById('articleImagePreview').innerHTML = a.cover_image 
                    ? '<img src="'+a.cover_image+'" style="max-height:100px;border-radius:4px">' : '';
                document.getElementById('articleModalTitle').textContent = 'Upravi≈• ƒçl√°nok';
            } catch(e) {
                console.error('Error loading article:', e);
                toast('Chyba pri naƒç√≠tan√≠ ƒçl√°nku', 'error');
                return;
            }
        }
        
        openModal('articleModal');
    }
    
    async function saveArticle() {
        const id = document.getElementById('articleId').value;
        const article = {
            title: document.getElementById('articleTitle').value,
            category_id: document.getElementById('articleCategory').value || null,
            author: document.getElementById('articleAuthor').value,
            status: document.getElementById('articleStatus').value,
            excerpt: document.getElementById('articleExcerpt').value,
            content: document.getElementById('articleContent').value,
            cover_image: document.getElementById('articleCoverImage').value,
            is_featured: document.getElementById('articleFeatured').checked,
            is_pinned: document.getElementById('articlePinned').checked
        };
        
        if (!article.title) {
            toast('N√°zov je povinn√Ω', 'error');
            return;
        }
        
        // Ak publikujeme, nastav√≠me d√°tum
        if (article.status === 'published') {
            article.published_at = new Date().toISOString();
        }
        
        try {
            const url = id ? `/api/articles/${id}` : '/api/articles';
            const method = id ? 'PUT' : 'POST';
            
            const res = await fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(article)
            });
            
            if (!res.ok) throw new Error('Chyba pri ukladan√≠');
            
            closeModal('articleModal');
            toast(id ? 'ƒål√°nok upraven√Ω' : 'ƒål√°nok vytvoren√Ω', 'success');
            loadArticles();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    function editArticle(id) {
        openArticleModal(id);
    }
    
    async function deleteArticle(id) {
        if (!confirm('Naozaj vymaza≈• ƒçl√°nok?')) return;
        await fetch(`/api/articles/${id}`, { method: 'DELETE' });
        loadArticles();
    }
    
    // GAL√âRIA
    async function loadAlbums() {
        try {
            const res = await fetch('/api/albums');
            const data = await res.json();
            const grid = document.getElementById('albumsGrid');
            
            if (!data.length) {
                grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:var(--muted);padding:2rem">≈Ωiadne albumy. Vytvorte prv√Ω album.</div>';
                return;
            }
            
            grid.innerHTML = data.map(a => `
                <div class="card" style="overflow:hidden">
                    <div style="height:150px;background:${a.cover_image ? `url(${a.cover_image}) center/cover` : 'linear-gradient(135deg,var(--primary),var(--secondary))'};display:flex;align-items:center;justify-content:center">
                        ${!a.cover_image ? '<span style="font-size:3rem">üñºÔ∏è</span>' : ''}
                    </div>
                    <div class="card-body">
                        <h4 style="margin-bottom:0.5rem">${a.title}</h4>
                        <p style="color:var(--muted);font-size:0.85rem;margin-bottom:0.5rem">${a.description || 'Bez popisu'}</p>
                        <div style="display:flex;justify-content:space-between;align-items:center">
                            <span style="font-size:0.85rem">${a.photos?.length || 0} fotiek</span>
                            <div>
                                <button class="btn btn-small" onclick="openAlbumPhotos('${a.id}')">üì∑</button>
                                <button class="btn btn-small" onclick="editAlbum('${a.id}')">‚úèÔ∏è</button>
                                <button class="btn btn-small btn-danger" onclick="deleteAlbum('${a.id}')">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        } catch(e) {
            document.getElementById('albumsGrid').innerHTML = '<div style="color:var(--danger)">Chyba: ' + e.message + '</div>';
        }
    }
    
    // Upload album cover
    async function uploadAlbumCover(input) {
        const file = input.files[0];
        if (!file) return;
        
        if (!file.type.startsWith('image/')) {
            toast('Pros√≠m vyberte obr√°zok', 'error');
            return;
        }
        if (file.size > 5 * 1024 * 1024) {
            toast('Maxim√°lna veƒækos≈• je 5MB', 'error');
            return;
        }
        
        document.getElementById('albumCoverPreview').innerHTML = '<span style="color:var(--muted)">Nahr√°vam...</span>';
        
        try {
            const base64 = await new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
            
            const res = await fetch('/api/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ file: base64, filename: file.name, folder: 'albums' })
            });
            
            const data = await res.json();
            if (data.error) throw new Error(data.error);
            
            document.getElementById('albumCover').value = data.url;
            document.getElementById('albumCoverPreview').innerHTML = '<img src="'+data.url+'" style="max-height:100px;border-radius:4px">';
            toast('Obr√°zok nahran√Ω!', 'success');
        } catch(e) {
            document.getElementById('albumCoverPreview').innerHTML = '';
            toast('Chyba pri nahr√°van√≠: ' + e.message, 'error');
        }
    }

    function openAlbumModal(id = null) {
        document.getElementById('albumForm').reset();
        document.getElementById('albumId').value = '';
        document.getElementById('albumModalTitle').textContent = 'Nov√Ω album';
        document.getElementById('albumPublic').checked = true;
        document.getElementById('albumCoverPreview').innerHTML = '';
        document.getElementById('albumCoverFile').value = '';
        openModal('albumModal');
    }
    
    async function saveAlbum() {
        const id = document.getElementById('albumId').value;
        const album = {
            title: document.getElementById('albumTitle').value,
            description: document.getElementById('albumDescription').value,
            cover_image: document.getElementById('albumCover').value,
            is_public: document.getElementById('albumPublic').checked
        };
        
        if (!album.title) {
            toast('N√°zov je povinn√Ω', 'error');
            return;
        }
        
        try {
            const url = id ? `/api/albums/${id}` : '/api/albums';
            const method = id ? 'PUT' : 'POST';
            
            const res = await fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(album)
            });
            
            if (!res.ok) throw new Error('Chyba pri ukladan√≠');
            
            closeModal('albumModal');
            toast(id ? 'Album upraven√Ω' : 'Album vytvoren√Ω', 'success');
            loadAlbums();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    async function editAlbum(id) {
        try {
            const res = await fetch(`/api/albums/${id}`);
            const a = await res.json();
            document.getElementById('albumId').value = a.id;
            document.getElementById('albumTitle').value = a.title || '';
            document.getElementById('albumDescription').value = a.description || '';
            document.getElementById('albumCover').value = a.cover_image || '';
            document.getElementById('albumPublic').checked = a.is_public !== false;
            document.getElementById('albumCoverFile').value = '';
            document.getElementById('albumCoverPreview').innerHTML = a.cover_image 
                ? '<img src="'+a.cover_image+'" style="max-height:100px;border-radius:4px">' : '';
            document.getElementById('albumModalTitle').textContent = 'Upravi≈• album';
            openModal('albumModal');
        } catch(e) {
            toast('Chyba pri naƒç√≠tan√≠ albumu', 'error');
        }
    }
    
    async function deleteAlbum(id) {
        if (!confirm('Naozaj vymaza≈• album a v≈°etky fotky?')) return;
        await fetch(`/api/albums/${id}`, { method: 'DELETE' });
        loadAlbums();
    }
    
    function openAlbumPhotos(id) {
        alert('Spr√°va fotiek v albume - TODO');
    }
    
    // STR√ÅNKY
    async function loadPages() {
        try {
            const res = await fetch('/api/pages');
            const data = await res.json();
            const tbody = document.getElementById('pagesTable');
            
            if (!data.length) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--muted)">≈Ωiadne str√°nky</td></tr>';
                return;
            }
            
            tbody.innerHTML = data.map(p => `
                <tr>
                    <td><strong>${p.title}</strong></td>
                    <td><code>/${p.slug}</code></td>
                    <td>${p.template}</td>
                    <td>${p.show_in_menu ? '‚úÖ' : '‚ùå'}</td>
                    <td>${p.is_published ? '<span style="color:var(--success)">Publikovan√°</span>' : '<span style="color:var(--muted)">Skryt√°</span>'}</td>
                    <td>
                        <button class="btn btn-small" onclick="editPage('${p.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deletePage('${p.id}')">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        } catch(e) {
            document.getElementById('pagesTable').innerHTML = '<tr><td colspan="6" style="color:var(--danger)">Chyba: ' + e.message + '</td></tr>';
        }
    }
    
    function openPageModal(id = null) {
        document.getElementById('pageForm').reset();
        document.getElementById('pageId').value = '';
        document.getElementById('pageModalTitle').textContent = 'Nov√° str√°nka';
        document.getElementById('pagePublished').checked = false;
        document.getElementById('pageInMenu').checked = false;
        openModal('pageModal');
    }
    
    async function savePage() {
        const id = document.getElementById('pageId').value;
        const page = {
            title: document.getElementById('pageTitle').value,
            slug: document.getElementById('pageSlug').value,
            template: document.getElementById('pageTemplate').value,
            menu_order: parseInt(document.getElementById('pageMenuOrder').value) || 0,
            content: document.getElementById('pageContent').value,
            is_published: document.getElementById('pagePublished').checked,
            show_in_menu: document.getElementById('pageInMenu').checked
        };
        
        if (!page.title || !page.slug) {
            toast('N√°zov a URL slug s√∫ povinn√©', 'error');
            return;
        }
        
        try {
            const url = id ? `/api/pages/${id}` : '/api/pages';
            const method = id ? 'PUT' : 'POST';
            
            const res = await fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(page)
            });
            
            if (!res.ok) throw new Error('Chyba pri ukladan√≠');
            
            closeModal('pageModal');
            toast(id ? 'Str√°nka upraven√°' : 'Str√°nka vytvoren√°', 'success');
            loadPages();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    async function editPage(id) {
        try {
            const res = await fetch(`/api/pages/${id}`);
            const p = await res.json();
            document.getElementById('pageId').value = p.id;
            document.getElementById('pageTitle').value = p.title || '';
            document.getElementById('pageSlug').value = p.slug || '';
            document.getElementById('pageTemplate').value = p.template || 'default';
            document.getElementById('pageMenuOrder').value = p.menu_order || 0;
            document.getElementById('pageContent').value = p.content || '';
            document.getElementById('pagePublished').checked = p.is_published || false;
            document.getElementById('pageInMenu').checked = p.show_in_menu || false;
            document.getElementById('pageModalTitle').textContent = 'Upravi≈• str√°nku';
            openModal('pageModal');
        } catch(e) {
            toast('Chyba pri naƒç√≠tan√≠ str√°nky', 'error');
        }
    }
    
    async function deletePage(id) {
        if (!confirm('Naozaj vymaza≈• str√°nku?')) return;
        await fetch(`/api/pages/${id}`, { method: 'DELETE' });
        loadPages();
    }
    
    // DOKUMENTY
    async function loadDocuments() {
        const category = document.getElementById('docCategoryFilter').value;
        let url = '/api/documents?';
        if (category) url += `category=${category}&`;
        
        try {
            const res = await fetch(url);
            const data = await res.json();
            const tbody = document.getElementById('documentsTable');
            
            if (!data.length) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--muted)">≈Ωiadne dokumenty</td></tr>';
                return;
            }
            
            tbody.innerHTML = data.map(d => {
                const size = d.file_size ? (d.file_size / 1024).toFixed(1) + ' KB' : '-';
                return `<tr>
                    <td><strong>${d.title}</strong></td>
                    <td>${d.category || '-'}</td>
                    <td><a href="${d.file_url}" target="_blank">${d.file_name || 'Stiahnu≈•'}</a></td>
                    <td>${size}</td>
                    <td>${d.download_count || 0}</td>
                    <td>
                        <button class="btn btn-small btn-danger" onclick="deleteDocument('${d.id}')">üóëÔ∏è</button>
                    </td>
                </tr>`;
            }).join('');
        } catch(e) {
            document.getElementById('documentsTable').innerHTML = '<tr><td colspan="6" style="color:var(--danger)">Chyba: ' + e.message + '</td></tr>';
        }
    }
    
    document.getElementById('docCategoryFilter').addEventListener('change', loadDocuments);
    
    // Upload dokumentu
    async function uploadDocument(input) {
        const file = input.files[0];
        if (!file) return;
        
        if (file.size > 10 * 1024 * 1024) {
            toast('Maxim√°lna veƒækos≈• je 10MB', 'error');
            return;
        }
        
        document.getElementById('docUploadStatus').innerHTML = '<span style="color:var(--muted)">Nahr√°vam...</span>';
        
        try {
            const base64 = await new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
            
            const res = await fetch('/api/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ file: base64, filename: file.name, folder: 'documents' })
            });
            
            const data = await res.json();
            if (data.error) throw new Error(data.error);
            
            document.getElementById('docFileUrl').value = data.url;
            document.getElementById('docFileName').value = file.name;
            document.getElementById('docUploadStatus').innerHTML = '<span style="color:var(--success)">‚úì ' + file.name + '</span>';
            toast('S√∫bor nahran√Ω!', 'success');
        } catch(e) {
            document.getElementById('docUploadStatus').innerHTML = '';
            toast('Chyba pri nahr√°van√≠: ' + e.message, 'error');
        }
    }

    function openDocumentModal() {
        document.getElementById('documentForm').reset();
        document.getElementById('docPublic').checked = true;
        document.getElementById('docUploadStatus').innerHTML = '';
        document.getElementById('docFile').value = '';
        openModal('documentModal');
    }
    
    async function saveDocument() {
        const doc = {
            title: document.getElementById('docTitle').value,
            category: document.getElementById('docCategory').value,
            file_url: document.getElementById('docFileUrl').value,
            file_name: document.getElementById('docFileName').value,
            description: document.getElementById('docDescription').value,
            is_public: document.getElementById('docPublic').checked
        };
        
        if (!doc.title || !doc.file_url) {
            toast('N√°zov a URL s√∫boru s√∫ povinn√©', 'error');
            return;
        }
        
        try {
            const res = await fetch('/api/documents', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(doc)
            });
            
            if (!res.ok) throw new Error('Chyba pri ukladan√≠');
            
            closeModal('documentModal');
            toast('Dokument pridan√Ω', 'success');
            loadDocuments();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    async function deleteDocument(id) {
        if (!confirm('Naozaj vymaza≈• dokument?')) return;
        try {
            await fetch(`/api/documents/${id}`, { method: 'DELETE' });
            toast('Dokument vymazan√Ω', 'success');
            loadDocuments();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    // PARTNERI
    async function loadPartners() {
        try {
            const res = await fetch('/api/partners');
            const data = await res.json();
            const grid = document.getElementById('partnersGrid');
            
            if (!data.length) {
                grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:var(--muted);padding:2rem">≈Ωiadni partneri</div>';
                return;
            }
            
            grid.innerHTML = data.map(p => `
                <div class="card">
                    <div class="card-body" style="text-align:center">
                        ${p.logo_url ? `<img src="${p.logo_url}" style="max-height:80px;margin-bottom:1rem;max-width:100%">` : '<div style="height:80px;display:flex;align-items:center;justify-content:center;font-size:2rem">ü§ù</div>'}
                        <h4>${p.name}</h4>
                        <span style="font-size:0.8rem;color:var(--muted)">${p.partner_type}</span>
                        ${p.website ? `<br><a href="${p.website}" target="_blank" rel="noopener" style="font-size:0.85rem">üîó Web</a>` : ''}
                        <div style="margin-top:0.5rem">
                            <button class="btn btn-small" onclick="editPartner('${p.id}')">‚úèÔ∏è</button>
                            <button class="btn btn-small btn-danger" onclick="deletePartner('${p.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
            `).join('');
        } catch(e) {
            document.getElementById('partnersGrid').innerHTML = '<div style="color:var(--danger)">Chyba: ' + e.message + '</div>';
        }
    }
    
    // Upload logo partnera
    async function uploadPartnerLogo(input) {
        const file = input.files[0];
        if (!file) return;
        
        // Valid√°cia
        if (!file.type.startsWith('image/')) {
            toast('Pros√≠m vyberte obr√°zok', 'error');
            return;
        }
        if (file.size > 2 * 1024 * 1024) {
            toast('Maxim√°lna veƒækos≈• je 2MB', 'error');
            return;
        }
        
        // Uk√°≈æ loading
        document.getElementById('partnerLogoPreview').innerHTML = '<span style="color:var(--muted)">Nahr√°vam...</span>';
        
        try {
            // Konvertuj na base64
            const base64 = await new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
            
            // Upload
            const res = await fetch('/api/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    file: base64,
                    filename: file.name,
                    folder: 'logos'
                })
            });
            
            const data = await res.json();
            
            if (data.error) throw new Error(data.error);
            
            // Nastav URL do inputu
            document.getElementById('partnerLogo').value = data.url;
            document.getElementById('partnerLogoPreview').innerHTML = `<img src="${data.url}" style="max-height:60px;border-radius:4px">`;
            toast('Logo nahran√©!', 'success');
        } catch(e) {
            document.getElementById('partnerLogoPreview').innerHTML = '';
            toast('Chyba pri nahr√°van√≠: ' + e.message, 'error');
        }
    }

    function openPartnerModal() {
        document.getElementById('partnerForm').reset();
        document.getElementById('partnerId').value = '';
        document.getElementById('partnerModalTitle').textContent = 'Nov√Ω partner';
        document.getElementById('partnerActive').checked = true;
        document.getElementById('partnerLogoPreview').innerHTML = '';
        document.getElementById('partnerLogoFile').value = '';
        openModal('partnerModal');
    }
    
    async function savePartner() {
        const id = document.getElementById('partnerId').value;
        const partner = {
            name: document.getElementById('partnerName').value,
            partner_type: document.getElementById('partnerType').value,
            website: document.getElementById('partnerWebsite').value || null,
            logo_url: document.getElementById('partnerLogo').value || null,
            sort_order: parseInt(document.getElementById('partnerOrder').value) || 0,
            is_active: document.getElementById('partnerActive').checked
        };
        
        if (!partner.name) {
            toast('N√°zov je povinn√Ω', 'error');
            return;
        }
        
        try {
            const url = id ? `/api/partners/${id}` : '/api/partners';
            const method = id ? 'PUT' : 'POST';
            
            const res = await fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(partner)
            });
            
            if (!res.ok) throw new Error('Chyba pri ukladan√≠');
            
            closeModal('partnerModal');
            toast(id ? 'Partner upraven√Ω' : 'Partner pridan√Ω', 'success');
            loadPartners();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    async function editPartner(id) {
        try {
            const res = await fetch('/api/partners');
            const partners = await res.json();
            const p = partners.find(x => x.id === id);
            if (!p) throw new Error('Partner nen√°jden√Ω');
            
            document.getElementById('partnerId').value = p.id;
            document.getElementById('partnerName').value = p.name || '';
            document.getElementById('partnerType').value = p.partner_type || 'partner';
            document.getElementById('partnerWebsite').value = p.website || '';
            document.getElementById('partnerLogo').value = p.logo_url || '';
            document.getElementById('partnerOrder').value = p.sort_order || 0;
            document.getElementById('partnerActive').checked = p.is_active !== false;
            document.getElementById('partnerLogoFile').value = '';
            document.getElementById('partnerLogoPreview').innerHTML = p.logo_url 
                ? `<img src="${p.logo_url}" style="max-height:60px;border-radius:4px">`
                : '';
            document.getElementById('partnerModalTitle').textContent = 'Upravi≈• partnera';
            openModal('partnerModal');
        } catch(e) {
            toast('Chyba pri naƒç√≠tan√≠ partnera', 'error');
        }
    }
    
    async function deletePartner(id) {
        if (!confirm('Naozaj vymaza≈• partnera?')) return;
        try {
            await fetch(`/api/partners/${id}`, { method: 'DELETE' });
            toast('Partner vymazan√Ω', 'success');
            loadPartners();
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }
    
    // NASTAVENIA
    document.querySelectorAll('[data-settings-tab]').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('[data-settings-tab]').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            document.querySelectorAll('.settings-tab-content').forEach(c => c.style.display = 'none');
            document.getElementById('settings' + tab.dataset.settingsTab.charAt(0).toUpperCase() + tab.dataset.settingsTab.slice(1)).style.display = 'block';
        });
    });
    
    async function loadSettings() {
        try {
            const res = await fetch('/api/settings');
            const settings = await res.json();
            
            Object.entries(settings).forEach(([key, value]) => {
                const el = document.getElementById('setting_' + key);
                if (el) el.value = value || '';
            });
        } catch(e) { console.error(e); }
    }
    
    async function saveSettings() {
        const settings = {};
        document.querySelectorAll('[id^="setting_"]').forEach(el => {
            const key = el.id.replace('setting_', '');
            settings[key] = el.value;
        });
        
        try {
            await fetch('/api/settings', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(settings)
            });
            toast('Nastavenia ulo≈æen√©', 'success');
        } catch(e) {
            toast('Chyba: ' + e.message, 'error');
        }
    }

    // Set today's date
    document.getElementById('trainingDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('vetDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('feedDate').value = new Date().toISOString().split('T')[0];
    </script>
</body>
</html>
